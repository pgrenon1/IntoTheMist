const _0x5266=['remove','_onLoadProgress','_ID_HIDE_TOKEN_BUTTON','progress','some','Drag-Drop\x20Images\x20as\x20Tokens','<span\x20class=\x22fas\x20fa-user\x22></span>','drop','off','naturalHeight','width','app','click','Plutonium\x20','\x22>\x0a\x09\x09\x09#controls\x20.scene-control[data-control=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09}\x0a\x09\x09</style>','getMaxWindowHeight','round','Could\x20not\x20directly\x20load\x20image\x20from\x20','_preInit_handleOpenClick','getPosCanvasSpace','activateListeners','Foundry\x20Assets','render','pct','getSceneControlButtons','_handleInstanceConfigUpdate','_URL_CORS_ANYWHERE','info','_handleConfigUpdate_toggleTileButton','plutonium__art__hide-token-button','\x22>\x0a\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TilesLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09}\x0a\x09\x09</style>','plutonium__art__hide-main-button','currentTarget','toBlob','plutonium.configUpdate','_pDoLoadAndPlaceImage','draw','CORS\x20Anywhere\x20(remote\x20server)','_handleInstanceConfigUpdate_cycleImportModeButton','append','P_GET_BACKEND_VERSION','_pCopyImageToLocalViaCorsAnywhere','_ID_HIDE_MAIN_BUTTON','push','C_ART_IMAGE_MODE_TOKEN','stringify','fas\x20fa-palette','uri','stopPropagation','STR_SEE_CONSOLE','_onClickLayer','artDirectoryPath','_activateListeners_pHandleDownloadAssets','_preInit_addTileButton','html','_pCopyImageToLocalViaBackend','Failed\x20to\x20load\x20image!\x20','tools','initialize','bind','dataTransfer','readyState','_INSTANCE','_BLOCKED_HOSTS','length','set','warn','replace','_preInit_addMainButton','TilesLayer','host','name','_ART_SCENE_CONTROLS_NAME','Drag-Drop\x20Images\x20as\x20Scenes','importImagesAs','catch','onload','_pDownloadPack','buttonDisplay','extract','_handleConfigUpdate_toggleTokenButton','_jsonDownloadMode','POST','_pLoadImageViaBackend','controls','_$btnCycleImportMode','title','status','naturalWidth','#board','\x20-\x20Scenes','last','notifications','then','pHandleButtonClick','_preInit_addNotesButton','artBrowser','path','body','_BASE_TITLE','_ID_HIDE_TILE_BUTTON','\x20-\x20Notes','upload','plutoniumDownloadPackImage','close','notes','Error\x20during\x20request\x20(','Download\x20complete!\x20Images\x20will\x20be\x20available\x20in\x20your\x20\x22User\x20Data\x22\x20directory.','p-0','setApplicationTitle','socket','_preInit_addSubmenuButton','preInit','_textDownloadMode','_handleConfigUpdate','pInit','\x22>\x0a\x09\x09\x09#controls\x20.scene-control[data-canvas-layer=\x22TokenLayer\x22]\x20.control-tool[data-tool=\x22ve-art__btn-scene\x22]\x20{\x0a\x09\x09\x09\x09display:\x20none\x20!important;\x0a\x09\x09\x09}\x0a\x09\x09</style>','Art\x20Browser','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x22\x20title=\x22Open\x20','canvas','backendEndpoint','appendTo','_pLoadImageViaCorsAnywhere','blob','<span\x20class=\x22fas\x20fa-cubes\x22></span>','_pLoadImage','_isDownloadingPack','Unhandled\x20drop\x20mode\x20\x22','C_ART_IMAGE_MODE_TILE','error','ve-Art','\x20-\x20Tokens','_preInit_addTokenButton','__bound__handleInstanceConfigUpdate','post','getData','_handleConfigUpdate_toggleMainButton','height','plutonium__art__hide-tile-button','type','_handleCustomDrop','open','<span\x20class=\x22fas\x20fa-map\x22></span>','artb__window-outer','create','artBrowserDownloadPack','TokenLayer','destroy','Sprite','split','_pPingImage','dataset','Failed\x20to\x20load\x20image!','get','isStreamerMode','.window-content','ve-art__btn-scene','Drag-Drop\x20Images\x20as\x20Tiles','source','C_ART_IMAGE_MODE_NOTE','artBrowserCopyToLocal','closest','tiles','application/json','find','icons/svg/book.svg','<style\x20id=\x22','Config\x20window\x22><span\x20class=\x22fas\x20fa-cogs\x22></span></button>','_doCancelPackDownload','control','.artr__item__lnk-fullsize','C_ART_IMAGE_MODE_SCENE','parse','tokenSize','token','text','\x20--\x20falling\x20back\x20on\x20alternate\x20loader:\x20'];(function(_0x42ff1f,_0x526651){const _0x2f7a68=function(_0x18eb72){while(--_0x18eb72){_0x42ff1f['push'](_0x42ff1f['shift']());}};_0x2f7a68(++_0x526651);}(_0x5266,0x19e));const _0x2f7a=function(_0x42ff1f,_0x526651){_0x42ff1f=_0x42ff1f-0x0;let _0x2f7a68=_0x5266[_0x42ff1f];return _0x2f7a68;};const _0x263403=_0x2f7a;'use strict';import{SharedConsts}from'../shared/SharedConsts.js';import{Util,LGT}from'./Util.js';import{Config}from'./Config.js';import{UtilCanvas}from'./UtilCanvas.js';import{ArtBrowser}from'../art-js/ArtBrowser.js';import{UtilApplications}from'./UtilApplications.js';class ArtBrowserApp extends Application{static[_0x263403('0x34')](){const _0x371c02=_0x263403;Hooks['on'](_0x371c02('0x8d'),_0x18eb72=>{const _0x586728=_0x371c02;if(!game['user']['isGM'])return;this[_0x586728('0x8')](_0x18eb72),this['_preInit_addTileButton'](_0x18eb72),this[_0x586728('0x48')](_0x18eb72),this[_0x586728('0x23')](_0x18eb72);});}static[_0x263403('0x87')](){const _0x292afd=_0x263403;if(ArtBrowserApp['_INSTANCE']){ArtBrowserApp[_0x292afd('0x2')]['render'](!![]),ArtBrowserApp[_0x292afd('0x2')]['maximize'](),UtilApplications['bringToFront'](ArtBrowserApp[_0x292afd('0x2')]);return;}ArtBrowserApp[_0x292afd('0x2')]=new ArtBrowserApp(),ArtBrowserApp['_INSTANCE'][_0x292afd('0x8b')](!![]);}static['_preInit_addMainButton'](_0x37c23e){const _0x453548=_0x263403,_0x3aa8c4=_0x37c23e['find'](_0x52b045=>_0x52b045[_0x453548('0xb')]===ArtBrowserApp[_0x453548('0xc')]);if(_0x3aa8c4)return;_0x37c23e[_0x453548('0xa0')]({'name':ArtBrowserApp[_0x453548('0xc')],'title':_0x453548('0x39'),'icon':'fas\x20fa-palette','tools':[{'name':ArtBrowserApp[_0x453548('0xc')],'title':_0x453548('0x39'),'icon':_0x453548('0xa3'),'onClick':()=>ui[_0x453548('0x20')][_0x453548('0x90')]('Hi!\x20You\x20shouldn\x27t\x20be\x20able\x20to\x20click\x20this,\x20something\x20has\x20gone\x20wrong.'),'button':!![]}],'activeTool':_0x453548('0x51')});}static['_preInit_getInnerToolMeta'](_0x29effa){const _0x107720=_0x263403;return{'name':ArtBrowserApp[_0x107720('0xc')],'title':'Art\x20Browser','icon':_0x107720('0xa3'),'onClick':()=>{const _0x8dcc83=_0x107720;Config[_0x8dcc83('0x5')](_0x8dcc83('0x24'),_0x8dcc83('0xe'),_0x29effa),ArtBrowserApp[_0x8dcc83('0x87')]();},'button':!![]};}static[_0x263403('0xaa')](_0x71825b){const _0x4e06c0=_0x263403;this[_0x4e06c0('0x33')](_0x71825b,_0x4e06c0('0x66'),Config[_0x4e06c0('0xa1')]);}static[_0x263403('0x48')](_0x1a2141){const _0x32098f=_0x263403;this[_0x32098f('0x33')](_0x1a2141,_0x32098f('0x72'),Config[_0x32098f('0x44')]);}static[_0x263403('0x23')](_0x13fbc8){const _0x476eff=_0x263403;this[_0x476eff('0x33')](_0x13fbc8,_0x476eff('0x2d'),Config[_0x476eff('0x63')]);}static['_preInit_addSubmenuButton'](_0x5345bf,_0x3a3a88,_0x22a478){const _0x29cad0=_0x263403,_0x31998b=_0x5345bf[_0x29cad0('0x68')](_0x25d52a=>_0x25d52a['name']===_0x3a3a88),_0x3f17b7=_0x31998b['tools'][_0x29cad0('0x79')](_0x5eb105=>_0x5eb105[_0x29cad0('0xb')]===ArtBrowserApp[_0x29cad0('0xc')]);if(_0x3f17b7)return;_0x31998b[_0x29cad0('0xae')][_0x29cad0('0xa0')](this['_preInit_getInnerToolMeta'](_0x22a478));}static async[_0x263403('0x11')](_0x2b64dc){const _0x48fd34=_0x263403;await fetch(Config[_0x48fd34('0x3c')],{'method':_0x48fd34('0x4a'),'headers':{'Content-Type':_0x48fd34('0x67')},'body':JSON['stringify']({'type':_0x48fd34('0x55'),'json':_0x2b64dc,'directoryPath':Config[_0x48fd34('0x5d')]('artBrowser',_0x48fd34('0xa8'))})});}static['init'](){const _0x342032=_0x263403,_0x2b5817=ui[_0x342032('0x18')][_0x342032('0xa7')][_0x342032('0xb0')](ui['controls']);ui[_0x342032('0x18')][_0x342032('0xa7')]=function(_0xf5a249){const _0x1f498a=_0x342032;if(_0xf5a249[_0x1f498a('0x95')][_0x1f498a('0x5b')][_0x1f498a('0x6d')]===ArtBrowserApp[_0x1f498a('0xc')]){ArtBrowserApp[_0x1f498a('0x87')]();return;}_0x2b5817(_0xf5a249);},ui[_0x342032('0x18')][_0x342032('0xaf')](),$(document[_0x342032('0x26')])['on']('dragstart',_0x342032('0x6e'),_0x423f52=>{const _0x3ec24b=_0x342032;_0x423f52[_0x3ec24b('0xa5')]();}),$(_0x342032('0x1d'))[0x0]['addEventListener'](_0x342032('0x7c'),this[_0x342032('0x50')][_0x342032('0xb0')](this)),game[_0x342032('0x32')]['on'](_0x342032('0x78'),_0x182a9a=>{const _0x127e65=_0x342032;if(_0x182a9a[_0x127e65('0x4f')]!==_0x127e65('0x2b'))return;if(!ArtBrowserApp[_0x127e65('0x2')])return;if(!ArtBrowserApp[_0x127e65('0x2')]['_isDownloadingPack'])return;SceneNavigation[_0x127e65('0x76')](_0x182a9a[_0x127e65('0x73')],_0x182a9a[_0x127e65('0x8c')]);}),Hooks['on'](_0x342032('0x97'),()=>this['_handleConfigUpdate']()),this[_0x342032('0x36')]();}constructor(){const _0x56f5dc=_0x263403;super({'title':ArtBrowserApp[_0x56f5dc('0x27')],'template':SharedConsts['MODULE_LOCATION']+'/template/ArtBrowserApp.handlebars','height':Util[_0x56f5dc('0x84')](),'width':Math['max'](0x258,Util['getMaxWindowWidth']()/0x2),'resizable':!![]}),this['_isDownloadingPack']=![],this[_0x56f5dc('0x19')]=null,this[_0x56f5dc('0x49')]=null;}static[_0x263403('0x36')](){const _0x6af954=_0x263403;this[_0x6af954('0x14')](),this[_0x6af954('0x91')](),this['_handleConfigUpdate_toggleMainButton']();}static[_0x263403('0x14')](){const _0x14ea2c=_0x263403,_0x5c3fd6=Config[_0x14ea2c('0x5d')](_0x14ea2c('0x24'),_0x14ea2c('0x12')),_0x1798e6=$('#'+ArtBrowserApp[_0x14ea2c('0x77')]);if(_0x5c3fd6[0x0])return _0x1798e6[_0x14ea2c('0x75')]();if(_0x1798e6[_0x14ea2c('0x4')])return;$(_0x14ea2c('0x6a')+ArtBrowserApp[_0x14ea2c('0x77')]+_0x14ea2c('0x38'))[_0x14ea2c('0x3d')](document['body']);}static[_0x263403('0x91')](){const _0x55eb8a=_0x263403,_0x1b2334=Config[_0x55eb8a('0x5d')]('artBrowser',_0x55eb8a('0x12')),_0x29422d=$('#'+ArtBrowserApp[_0x55eb8a('0x28')]);if(_0x1b2334[0x1])return _0x29422d[_0x55eb8a('0x75')]();if(_0x29422d[_0x55eb8a('0x4')])return;$(_0x55eb8a('0x6a')+ArtBrowserApp['_ID_HIDE_TILE_BUTTON']+_0x55eb8a('0x93'))['appendTo'](document[_0x55eb8a('0x26')]);}static[_0x263403('0x4c')](){const _0x3f43e3=_0x263403,_0x450201=Config[_0x3f43e3('0x5d')](_0x3f43e3('0x24'),_0x3f43e3('0x12')),_0x51113e=$('#'+ArtBrowserApp[_0x3f43e3('0x9f')]);if(_0x450201[0x2])return _0x51113e[_0x3f43e3('0x75')]();if(_0x51113e[_0x3f43e3('0x4')])return;$(_0x3f43e3('0x6a')+ArtBrowserApp[_0x3f43e3('0x9f')]+_0x3f43e3('0x83'))['appendTo'](document[_0x3f43e3('0x26')]);}[_0x263403('0x8e')](){const _0x24de29=_0x263403;this[_0x24de29('0x9b')]();}[_0x263403('0x9b')](){const _0xd1de17=_0x263403,_0x2fde56=Config[_0xd1de17('0x5d')]('artBrowser',_0xd1de17('0xe'))||0x0;switch(_0x2fde56){case Config['C_ART_IMAGE_MODE_TOKEN']:this['_$btnCycleImportMode'][_0xd1de17('0xab')](_0xd1de17('0x40'))[_0xd1de17('0x1a')](_0xd1de17('0x61')),UtilApplications[_0xd1de17('0x31')](this,ArtBrowserApp['_BASE_TITLE']+'\x20-\x20Tiles');break;case Config['C_ART_IMAGE_MODE_TILE']:this[_0xd1de17('0x19')][_0xd1de17('0xab')](_0xd1de17('0x7b'))[_0xd1de17('0x1a')](_0xd1de17('0x7a')),UtilApplications[_0xd1de17('0x31')](this,ArtBrowserApp[_0xd1de17('0x27')]+_0xd1de17('0x47'));break;case Config[_0xd1de17('0x63')]:this[_0xd1de17('0x19')]['html']('<span\x20class=\x22fas\x20fa-bookmark\x22></span>')[_0xd1de17('0x1a')]('Drag-Drop\x20Images\x20as\x20Notes'),UtilApplications[_0xd1de17('0x31')](this,ArtBrowserApp[_0xd1de17('0x27')]+_0xd1de17('0x29'));break;case Config['C_ART_IMAGE_MODE_SCENE']:this[_0xd1de17('0x19')][_0xd1de17('0xab')](_0xd1de17('0x52'))[_0xd1de17('0x1a')](_0xd1de17('0xd')),UtilApplications[_0xd1de17('0x31')](this,ArtBrowserApp[_0xd1de17('0x27')]+_0xd1de17('0x1e'));break;default:throw new Error(_0xd1de17('0x43')+_0x2fde56+'\x22');}}[_0x263403('0x4b')](){const _0x3c28a=_0x263403;return{'owner':!![],'entity':{'name':_0x3c28a('0x39')}};}[_0x263403('0x89')](_0x55fed5){const _0x28f6fa=_0x263403,_0x3d7957=this;this['__bound__handleInstanceConfigUpdate']=this[_0x28f6fa('0x8e')][_0x28f6fa('0xb0')](this),Hooks['on']('plutonium.configUpdate',this[_0x28f6fa('0x49')]),_0x55fed5[_0x28f6fa('0x65')](_0x28f6fa('0x5f'))['addClass'](_0x28f6fa('0x30'))['addClass'](_0x28f6fa('0x53'));const _0x4161eb=new ArtBrowser(_0x55fed5);_0x4161eb['_pGetDownloadModes']=async function(){const _0x16370e=_0x28f6fa,_0x3dd9a0=[this[_0x16370e('0x35')],this[_0x16370e('0x15')]];return await Config[_0x16370e('0x9d')]&&_0x3dd9a0['unshift']({'name':_0x16370e('0x8a'),'isMultipleFilesOnly':!![],'pDownloadAsMultipleFiles':(_0x3aaeff,_0x4f5ac9,_0x515ce6)=>_0x3d7957[_0x16370e('0xa9')](_0x3aaeff,_0x4f5ac9,_0x515ce6)}),_0x3dd9a0;},_0x4161eb[_0x28f6fa('0x37')]()[_0x28f6fa('0x21')](()=>{const _0xb823fc=_0x28f6fa,_0x5f4de6=_0x55fed5['find']('.artr__search'),_0xc7590b=$('<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22\x20title=\x22Cancel\x20running\x20downloads\x22><span\x20class=\x22fas\x20fa-stop\x22></span></button>')[_0xb823fc('0x81')](()=>ArtBrowserApp[_0xb823fc('0x6c')]());this['_$btnCycleImportMode']=$('<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22><span\x20class=\x22fas\x20fa-spinner\x22></span></button>')['click'](()=>{const _0x7df244=_0xb823fc,_0x29a01f=Config[_0x7df244('0x5d')](_0x7df244('0x24'),_0x7df244('0xe'))||0x0,_0x16d5e5=_0x29a01f===Config[_0x7df244('0x6f')]?Config[_0x7df244('0xa1')]:_0x29a01f+0x1;Config[_0x7df244('0x5')](_0x7df244('0x24'),_0x7df244('0xe'),_0x16d5e5);});const _0x2aec97=$(_0xb823fc('0x3a')+(Config['get']('ui',_0xb823fc('0x5e'))?'':_0xb823fc('0x82'))+_0xb823fc('0x6b'))[_0xb823fc('0x81')](_0x4e2863=>Config[_0xb823fc('0x22')](_0x4e2863,_0xb823fc('0x24')));$$`<div class="flex-v-center h-100">
					<div class="artr__search__divider mx-2"></div>
					<div class="flex-v-center">${_0xc7590b}</div>
					<div class="flex-v-center">${this['_$btnCycleImportMode']}</div>
					<div class="flex-v-center">${_0x2aec97}</div>
				</div>`[_0xb823fc('0x3d')](_0x5f4de6),this['__bound__handleInstanceConfigUpdate']();});}static async[_0x263403('0x6c')](){const _0x37f2cb=_0x263403;await fetch(Config[_0x37f2cb('0x3c')],{'method':_0x37f2cb('0x4a'),'headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'type':'artBrowserCancelDownloadPack'})});}async[_0x263403('0xa9')](_0x28333b,_0x23f945,_0x7aa69d){const _0x50f34c=_0x263403;try{ArtBrowserApp[_0x50f34c('0x2')]['_isDownloadingPack']=!![],await ArtBrowserApp[_0x50f34c('0x11')](_0x28333b);}catch(_0x482cfa){ArtBrowserApp[_0x50f34c('0x2')]['_isDownloadingPack']=![];}_0x23f945+0x1===_0x7aa69d&&(ArtBrowserApp[_0x50f34c('0x2')][_0x50f34c('0x42')]=![],ui['notifications'][_0x50f34c('0x90')](_0x50f34c('0x2f')));}static[_0x263403('0x50')](_0xd54006){const _0xfcf949=_0x263403;let _0x305aa9;try{const _0x344241=_0xd54006[_0xfcf949('0x0')][_0xfcf949('0x4b')](_0xfcf949('0x67'));if(!_0x344241)return;_0x305aa9=JSON[_0xfcf949('0x70')](_0x344241);}catch(_0x38caca){ui[_0xfcf949('0x20')][_0xfcf949('0x45')](_0xfcf949('0xad')+VeCt['STR_SEE_CONSOLE']),setTimeout(()=>{throw _0x38caca;});}if(!_0x305aa9||_0x305aa9[_0xfcf949('0x4f')]!==_0xfcf949('0x46'))return;return this[_0xfcf949('0x98')](_0xd54006,_0x305aa9)[_0xfcf949('0xf')](_0x32d1db=>{const _0x5e09d0=_0xfcf949;ui[_0x5e09d0('0x20')][_0x5e09d0('0x45')]('Failed\x20to\x20load\x20image!\x20'+VeCt[_0x5e09d0('0xa6')]),setTimeout(()=>{throw _0x32d1db;});}),![];}static async['_pDoLoadAndPlaceImage'](_0x41d28c,_0x225102){const _0x48fd67=_0x263403,_0x540987=Config[_0x48fd67('0x5d')](_0x48fd67('0x24'),'importImagesAs')||0x0;let _0x4356eb=_0x225102[_0x48fd67('0xa4')],_0x274a81,_0x5de88b,_0x3d5795;if(await this[_0x48fd67('0x5a')](_0x4356eb))_0x274a81=await this['_pLoadImage'](_0x4356eb);else{const _0x4215bf=await Config['P_GET_BACKEND_VERSION'];console[_0x48fd67('0x6')](...LGT,_0x48fd67('0x86')+_0x4356eb+_0x48fd67('0x74')+(_0x4215bf?'backend\x20mod':_0x48fd67('0x9a'))+'.');try{if(_0x4215bf){const {url:_0x86b94d,image:_0x310f71}=await this['_pLoadImageViaBackend'](_0x4356eb);_0x4356eb=_0x86b94d,_0x274a81=_0x310f71;}else{const {url:_0x538b08,image:_0x48f444}=await this[_0x48fd67('0x3e')](_0x4356eb);_0x4356eb=_0x538b08,_0x274a81=_0x48f444;}}catch(_0x475ea1){console[_0x48fd67('0x45')](...LGT,_0x48fd67('0x5c'),_0x475ea1),ui[_0x48fd67('0x20')][_0x48fd67('0x45')](_0x48fd67('0xad')+VeCt['STR_SEE_CONSOLE']);return;}}const _0x114999=()=>{const _0x1703ad=_0x48fd67;let _0x35ce09=_0x4356eb[_0x1703ad('0x59')]('/')[_0x1703ad('0x1f')]();try{_0x35ce09=decodeURIComponent(_0x35ce09),_0x35ce09=_0x35ce09[_0x1703ad('0x59')]('.')[0x0],_0x35ce09=_0x35ce09[_0x1703ad('0x7')](/_/g,'\x20')[_0x1703ad('0x7')](/\s+/g,'\x20')[_0x1703ad('0x7')](/\d+\s*[xX*]\s*\d+/g,'');}catch(_0x377cbd){}return _0x35ce09;};_0x5de88b=_0x274a81[_0x48fd67('0x1c')],_0x3d5795=_0x274a81[_0x48fd67('0x7e')];let _0x2d7a12=Config[_0x48fd67('0x5d')](_0x48fd67('0x24'),'scale');switch(_0x540987){case Config[_0x48fd67('0xa1')]:{const _0x290e80=UtilCanvas[_0x48fd67('0x88')](_0x41d28c,_0x48fd67('0x9'));Tile[_0x48fd67('0x54')]({'img':encodeURL(_0x4356eb),'width':Math[_0x48fd67('0x85')](_0x5de88b*_0x2d7a12),'height':Math['round'](_0x3d5795*_0x2d7a12),'hidden':![],'scale':_0x2d7a12,'x':_0x290e80['x'],'y':_0x290e80['y']});break;}case Config[_0x48fd67('0x44')]:{const _0x8cbe48=UtilCanvas[_0x48fd67('0x88')](_0x41d28c,_0x48fd67('0x56')),_0x1d8248=Config['get']('artBrowser',_0x48fd67('0x71'))||0x1;Token['create']({'name':'-','x':_0x8cbe48['x'],'y':_0x8cbe48['y'],'img':encodeURL(_0x4356eb),'width':_0x1d8248,'height':_0x1d8248,'scale':0x1});break;}case Config['C_ART_IMAGE_MODE_NOTE']:{const _0x56f67f=UtilCanvas[_0x48fd67('0x88')](_0x41d28c,'NotesLayer'),_0x585e9a=await JournalEntry[_0x48fd67('0x54')]({'name':_0x114999(),'img':encodeURL(_0x4356eb)});Note['create']({'entryId':_0x585e9a['id'],'icon':_0x48fd67('0x69'),'iconSize':0x28,'text':'','x':_0x56f67f['x'],'y':_0x56f67f['y']});break;}case Config[_0x48fd67('0x6f')]:{const _0x1e9af1={'name':_0x114999(),'active':!![],'navigation':!![],'img':encodeURL(_0x4356eb),'width':Math[_0x48fd67('0x85')](_0x5de88b*_0x2d7a12),'height':Math['round'](_0x3d5795*_0x2d7a12)},_0x3d1bd7=await Scene[_0x48fd67('0x54')](_0x1e9af1,{'renderSheet':!![]});canvas[_0x48fd67('0x99')]();break;}}}static async['_pPingImage'](_0x258b6e){const _0x527d28=_0x263403;let _0x17781c;try{_0x17781c=new URL(_0x258b6e);}catch(_0x295131){}if(_0x17781c&&ArtBrowserApp[_0x527d28('0x3')][_0x17781c[_0x527d28('0xa')]])return![];try{const _0x420363=await fetch(_0x258b6e);return await _0x420363[_0x527d28('0x3f')](),!![];}catch(_0xb52631){if(_0x17781c)ArtBrowserApp[_0x527d28('0x3')][_0x17781c[_0x527d28('0xa')]]=!![];return![];}}static[_0x263403('0x41')](_0xb44369){return new Promise((_0x17e260,_0x57f89d)=>{const _0x13c51c=_0x2f7a,_0x568c40=new Image();_0x568c40['onerror']=_0x1405fb=>_0x57f89d(_0x1405fb),_0x568c40[_0x13c51c('0x10')]=()=>_0x17e260(_0x568c40),_0x568c40['src']=_0xb44369;});}static async[_0x263403('0xac')](_0x21190b){const _0x5de50f=_0x263403,_0x4484d3=await fetch(Config[_0x5de50f('0x3c')],{'method':_0x5de50f('0x4a'),'headers':{'Content-Type':_0x5de50f('0x67')},'body':JSON[_0x5de50f('0xa2')]({'type':_0x5de50f('0x64'),'url':_0x21190b,'directoryPath':Config['get'](_0x5de50f('0x24'),_0x5de50f('0xa8'))})}),_0x558361=await _0x4484d3['json']();return _0x558361[_0x5de50f('0x25')];}static async[_0x263403('0x17')](_0x54f438){const _0x517ecf=_0x263403,_0x3a0315=await this[_0x517ecf('0xac')](_0x54f438),_0x45ed1f=await this['_pLoadImage'](_0x3a0315);return{'url':_0x3a0315,'image':_0x45ed1f};}static async[_0x263403('0x9e')](_0x2d984a){const _0x33adf6=_0x263403,_0x409333=''+ArtBrowserApp[_0x33adf6('0x8f')]+_0x2d984a,_0x11ce34=async _0x39d309=>{const _0x12eb56=_0x33adf6,_0x207afc=Config[_0x12eb56('0x5d')](_0x12eb56('0x24'),_0x12eb56('0xa8')),_0x238559=_0x2d984a['split']('/')['last']()+'.webp',_0x563cce=(_0x207afc+'/'+_0x238559)[_0x12eb56('0x7')](/\/+/g,'/'),_0x27f621=new FormData();return _0x27f621[_0x12eb56('0x9c')]('target',_0x207afc),_0x27f621[_0x12eb56('0x9c')](_0x12eb56('0x2a'),_0x39d309,_0x238559),_0x27f621[_0x12eb56('0x9c')](_0x12eb56('0x62'),'data'),await new Promise((_0x43d222,_0x3c6637)=>{const _0x43f3ea=_0x12eb56,_0x4ce70c=new XMLHttpRequest();_0x4ce70c[_0x43f3ea('0x51')](_0x43f3ea('0x16'),'/upload',!![]),_0x4ce70c['onreadystatechange']=()=>{const _0x1ac5de=_0x43f3ea;if(_0x4ce70c[_0x1ac5de('0x1')]!==0x4)return;if(_0x4ce70c[_0x1ac5de('0x1b')]<0xc8||_0x4ce70c['status']>=0x190)_0x3c6637(new Error(_0x1ac5de('0x2e')+_0x4ce70c[_0x1ac5de('0x1b')]+')'));_0x43d222();},_0x4ce70c['send'](_0x27f621);}),_0x563cce;},_0xe2e82b=await loadTexture(_0x409333),_0x5d8825=new PIXI[(_0x33adf6('0x58'))](_0xe2e82b),_0x208db0=PIXI['RenderTexture']['create'](_0x5d8825[_0x33adf6('0x7f')],_0x5d8825[_0x33adf6('0x4d')]);canvas['app']['renderer'][_0x33adf6('0x8b')](_0x5d8825,_0x208db0);const _0x58c642=new PIXI['Sprite'](_0x208db0),_0x3460f2=await new Promise((_0x423d7c,_0x5251b8)=>{const _0x31d67e=_0x33adf6;canvas[_0x31d67e('0x80')]['renderer'][_0x31d67e('0x13')][_0x31d67e('0x3b')](_0x58c642)[_0x31d67e('0x96')](async _0x34c53e=>{try{const _0x5c4380=await _0x11ce34(_0x34c53e);_0x423d7c(_0x5c4380);}catch(_0x2a4d1b){_0x5251b8(_0x2a4d1b);}},'image/webp',0x1);});return _0x208db0[_0x33adf6('0x57')](!![]),_0x3460f2;}static async[_0x263403('0x3e')](_0x15a157){const _0xc30165=_0x263403,_0xa5b767=await this[_0xc30165('0x9e')](_0x15a157),_0x5faae4=await this[_0xc30165('0x41')](_0xa5b767);return{'url':_0xa5b767,'image':_0x5faae4};}async[_0x263403('0x2c')](..._0xcea864){const _0xb9d24e=_0x263403;await super[_0xb9d24e('0x2c')](..._0xcea864),Hooks[_0xb9d24e('0x7d')](_0xb9d24e('0x97'),this[_0xb9d24e('0x49')]),ArtBrowserApp[_0xb9d24e('0x2')]=null;}}ArtBrowserApp['_BLOCKED_HOSTS']={},ArtBrowserApp[_0x263403('0x2')]=null,ArtBrowserApp[_0x263403('0x77')]=_0x263403('0x92'),ArtBrowserApp[_0x263403('0x28')]=_0x263403('0x4e'),ArtBrowserApp[_0x263403('0x9f')]=_0x263403('0x94'),ArtBrowserApp[_0x263403('0x8f')]='https://cors-anywhere.herokuapp.com/',ArtBrowserApp[_0x263403('0xc')]=_0x263403('0x60'),ArtBrowserApp[_0x263403('0x27')]=_0x263403('0x39');export{ArtBrowserApp};