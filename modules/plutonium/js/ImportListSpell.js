const _0x18ef=['pGetSources','val','absorbFnGetData','\x22\x20(from\x20\x22','Import\x20and\x20Set\x20Preparation\x20Details','MODULE_LOCATION','spSchoolAndSubschoolsAbvsShort','0-3','Level','_pageFilter','5etools','_titleButtonRun','spells','sourceJsonToAbv','get','school','map','[name=\x22sel-preparation-mode\x22]','_isConc','technomagic','name','Name','pGetSpellItem','getData','level','items','initBtnSortHandlers','_resolve','pGetAllSpells','titleSearch','sourceJsonToFull','isNonstandardSource','sortSpells','Importing\x20spell\x20\x22','activateListeners','Set\x20Preparation\x20Details','ritual','_pImportEntry_pImportToActor','mutateForFilters','preparation.mode','Import\x20Spells','_isUseMods','pImportEntry','[name=\x22btn-run\x22]','[name=\x22sel-is-prepared\x22]','render','sourceShort','URL_TO_HASH_BUILDER','_actor','text-center','concentration','_normalisedTime','_pFnPostProcessEntries','getMaxWindowHeight','SOURCE_TYP_ARCANA','_list','_l_time','log','foundryData','_isPreviewable','spLevelToFull','5etools-spells','close','SRD','\x20(rit.)','entries','find','_dataList','time','schoolShort','.veapp__list','getSpellUrl','Source','[data-name=\x22wrp-btns-sort\x22]','getListDisplayLevel','copy','isStreamerMode','spSchoolAbvToFull','DetailPreparation','_content','getSpellItemItemOpts','SOURCE_TYP_CUSTOM','meta','isToken','click','_pImportEntry_pImportToDirectoryGeneric','_$btnReset','[name=\x22btn-reset\x22]','subschools','\x20level','SOURCE_TYP_OFFICIAL_ALL','SOURCE_TYP_BREW','sourceJsonToColor','TASK_EXIT_COMPLETE','Custom\x20URL','_activateListeners_absorbListItems','doAbsorbItems','schoolLong','spRangeToFull','source','createEmbeddedEntity','Time','Item','spell','DataSourceFile','preparation.prepared','sourceClassName','_l_school','DataSourceUrl','OwnedItem','SOURCE_TYP_OFFICIAL_SINGLE','_titleSearch','getFolderPathMeta','\x20(tec.)','isTemp','2-5','btn-run-mods','.search','constructor','School','Spell\x20Points','_pImportEntry_pImportToDirectoryGeneric_pGetImportableData'];(function(_0x44bd8b,_0x18ef40){const _0x3030b6=function(_0x3a8107){while(--_0x3a8107){_0x44bd8b['push'](_0x44bd8b['shift']());}};_0x3030b6(++_0x18ef40);}(_0x18ef,0xe3));const _0x3030=function(_0x44bd8b,_0x18ef40){_0x44bd8b=_0x44bd8b-0x0;let _0x3030b6=_0x18ef[_0x44bd8b];return _0x3030b6;};const _0x3cc93e=_0x3030;'use strict';import{ImportList}from'./ImportList.js';import{Vetools}from'./Vetools.js';import{LGT,Util}from'./Util.js';import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{DataConverterSpell}from'./DataConverterSpell.js';import{SharedConsts}from'../shared/SharedConsts.js';import{ImportListCreature}from'./ImportListCreature.js';import{UtilApplications}from'./UtilApplications.js';class ImportListSpell extends ImportList{constructor(_0x3a8107){const _0x31ff06=_0x3030;_0x3a8107=_0x3a8107||{},super({'title':_0x31ff06('0x39')},_0x3a8107,{'props':[_0x31ff06('0x78')],'titleSearch':_0x31ff06('0x1d'),'sidebarTab':_0x31ff06('0x2a'),'gameProp':_0x31ff06('0x2a'),'defaultFolderPath':['Spells'],'folderType':_0x31ff06('0x77'),'fnListSort':PageFilterSpells[_0x31ff06('0x31')],'pageFilter':new PageFilterSpells(),'page':UrlUtil['PG_SPELLS'],'isPreviewable':!![],'isModdable':!![],'isDedupable':!![]});}async[_0x3cc93e('0x11')](){const _0x377b76=_0x3cc93e,_0x1bd88b=await Vetools['pGetSpellIndex']();return[new ImportList['DataSourceSpecial'](Config[_0x377b76('0x1f')]('ui',_0x377b76('0x5d'))?_0x377b76('0x50'):_0x377b76('0x1b'),async()=>(await Vetools[_0x377b76('0x2d')]())[_0x377b76('0x78')],{'cacheKey':_0x377b76('0x4e'),'filterTypes':[ImportList[_0x377b76('0x6b')]],'isDefault':!![]}),new ImportList[(_0x377b76('0x3'))](_0x377b76('0x6f'),'',{'filterTypes':[ImportList[_0x377b76('0x62')]]}),new ImportList[(_0x377b76('0x79'))]('Upload\x20File',{'filterTypes':[ImportList[_0x377b76('0x62')]]}),...Object[_0x377b76('0x52')](_0x1bd88b)['map'](([_0xa04327,_0x388e05])=>new ImportList['DataSourceUrl'](Parser[_0x377b76('0x2f')](_0xa04327),Vetools[_0x377b76('0x58')](_0x388e05),{'source':_0xa04327,'filterTypes':SourceUtil[_0x377b76('0x30')](_0xa04327)?[ImportList[_0x377b76('0x47')]]:[ImportList[_0x377b76('0x5')]]})),...(await Vetools['pGetHomebrewSources'](_0x377b76('0x78')))[_0x377b76('0x21')](({name:_0x3492ce,url:_0x379431})=>new ImportList[(_0x377b76('0x3'))](_0x3492ce,_0x379431,{'filterTypes':[ImportList[_0x377b76('0x6c')]]}))];}['getFolderPathMeta'](){const _0xb88370=_0x3cc93e;return{...super[_0xb88370('0x7')](),'level':{'label':_0xb88370('0x19'),'getter':_0x2d20d6=>''+Parser['spLevelToFull'](_0x2d20d6['level'])+(_0x2d20d6[_0xb88370('0x29')]?_0xb88370('0x6a'):'')},'spellPoints':{'label':_0xb88370('0xf'),'getter':_0x1a28da=>{const _0x41cc0d=(()=>{const _0x208ab1=_0x3030;switch(_0x1a28da[_0x208ab1('0x29')]){case 0x1:return 0x2;case 0x2:return 0x3;case 0x3:return 0x5;case 0x4:return 0x6;case 0x5:return 0x7;case 0x6:return 0x8;case 0x7:return 0xa;case 0x8:return 0xb;case 0x9:return 0xd;case 0x0:default:return 0x0;}})();return _0x41cc0d+'\x20Spell\x20Points';}}};}['getData'](){const _0x4b0f97=_0x3cc93e;return{'isPreviewable':this[_0x4b0f97('0x4c')],'titleButtonRun':this[_0x4b0f97('0x1c')],'titleSearch':this[_0x4b0f97('0x6')],'buttonsAdditional':[{'name':_0x4b0f97('0xb'),'text':_0x4b0f97('0x15')}],'cols':[{'name':_0x4b0f97('0x26'),'width':'3-2','field':_0x4b0f97('0x25')},{'name':_0x4b0f97('0x19'),'width':0x1,'field':_0x4b0f97('0x29'),'rowClassName':'text-center'},{'name':_0x4b0f97('0x76'),'width':0x2,'field':_0x4b0f97('0x55'),'rowClassName':'text-center'},{'name':_0x4b0f97('0xe'),'width':0x1,'field':'school','titleProp':_0x4b0f97('0x72'),'displayProp':_0x4b0f97('0x56'),'classNameProp':'schoolClassName','rowClassName':_0x4b0f97('0x42')},{'name':'C.','width':_0x4b0f97('0x18'),'field':_0x4b0f97('0x43'),'rowClassName':_0x4b0f97('0x42'),'title':'Concentration'},{'name':'Range','width':_0x4b0f97('0xa'),'field':'range','rowClassName':'text-right'},{'name':_0x4b0f97('0x59'),'width':0x1,'field':_0x4b0f97('0x74'),'titleProp':'sourceLong','displayProp':_0x4b0f97('0x3f'),'classNameProp':_0x4b0f97('0x1'),'rowClassName':_0x4b0f97('0x42')}],'rows':this[_0x4b0f97('0x60')][_0x4b0f97('0x21')]((_0x443d69,_0x149587)=>{const _0x1c4a63=_0x4b0f97;return this[_0x1c4a63('0x1a')][_0x1c4a63('0x37')](_0x443d69),_0x443d69[_0x1c4a63('0x49')]=PageFilterSpells['getTblTimeStr'](_0x443d69['time'][0x0]),_0x443d69[_0x1c4a63('0x2')]=Parser[_0x1c4a63('0x5e')](_0x443d69['school'],_0x443d69['subschools']),{'name':_0x443d69[_0x1c4a63('0x25')],'level':this[_0x1c4a63('0xd')][_0x1c4a63('0x5b')](_0x443d69),'time':_0x443d69[_0x1c4a63('0x49')],'range':Parser[_0x1c4a63('0x73')](_0x443d69['range']),'source':_0x443d69[_0x1c4a63('0x74')],'sourceShort':Parser[_0x1c4a63('0x1e')](_0x443d69[_0x1c4a63('0x74')]),'sourceLong':Parser['sourceJsonToFull'](_0x443d69['source']),'sourceClassName':Parser[_0x1c4a63('0x6d')](_0x443d69[_0x1c4a63('0x74')]),'school':_0x443d69[_0x1c4a63('0x20')],'schoolShort':Parser[_0x1c4a63('0x17')](_0x443d69[_0x1c4a63('0x20')],_0x443d69[_0x1c4a63('0x69')]),'schoolLong':_0x443d69[_0x1c4a63('0x2')],'schoolClassName':'sp__school-'+_0x443d69[_0x1c4a63('0x20')],'concentration':_0x443d69[_0x1c4a63('0x23')]?'Ã—':'','ix':_0x149587};})};}[_0x3cc93e('0x70')](){const _0x4ad2b3=_0x3cc93e;this[_0x4ad2b3('0x48')][_0x4ad2b3('0x71')](this[_0x4ad2b3('0x60')],{'fnGetName':_0x4eeaf5=>_0x4eeaf5['name'],'fnGetValues':_0x387cda=>({'source':_0x387cda['source'],'level':_0x387cda[_0x4ad2b3('0x29')],'time':_0x387cda['_l_time'],'normalisedTime':_0x387cda[_0x4ad2b3('0x44')],'normalisedRange':_0x387cda['_normalisedRange'],'school':_0x387cda[_0x4ad2b3('0x2')],'concentration':_0x387cda[_0x4ad2b3('0x23')],'hash':UrlUtil[_0x4ad2b3('0x40')][this['_page']](_0x387cda)}),'fnGetData':UtilList2[_0x4ad2b3('0x13')],'fnBindListeners':_0xf62088=>UtilList2['absorbFnBindListeners'](this['_list'],_0xf62088)});}[_0x3cc93e('0x45')](_0x5432b5){const _0x2c0dc8=_0x3cc93e;if(!this[_0x2c0dc8('0x3a')])return _0x5432b5;return new Promise(_0x483768=>{const _0x14eae0=_0x2c0dc8,_0x15eb78=new ImportListSpell[(_0x14eae0('0x5f'))](_0x5432b5,_0x483768,{'titleSearch':this[_0x14eae0('0x6')]});_0x15eb78[_0x14eae0('0x3e')](!![]);});}async[_0x3cc93e('0x3b')](_0x249ba2,_0xb5dca8){const _0x278a0d=_0x3cc93e;_0xb5dca8=_0xb5dca8||{},console[_0x278a0d('0x4a')](...LGT,_0x278a0d('0x32')+_0x249ba2[_0x278a0d('0x25')]+_0x278a0d('0x14')+Parser['sourceJsonToAbv'](_0x249ba2[_0x278a0d('0x74')])+'\x22)');if(_0xb5dca8[_0x278a0d('0x9')])return this['_pImportEntry_pImportToDirectoryGeneric'](_0x249ba2,_0xb5dca8);else{if(this[_0x278a0d('0x41')])return this['_pImportEntry_pImportToActor'](_0x249ba2,_0xb5dca8);else return this[_0x278a0d('0x66')](_0x249ba2,_0xb5dca8);}}async[_0x3cc93e('0x36')](_0x2a9ed1,_0x440ff1){const _0x157f33=_0x3cc93e,_0x2bbb8e=await this[_0x157f33('0x41')][_0x157f33('0x75')](_0x157f33('0x4'),await DataConverterSpell['pGetSpellItem'](_0x2a9ed1,UtilActors['getActorSpellItemOpts'](this[_0x157f33('0x41')])),{});if(this[_0x157f33('0x41')][_0x157f33('0x64')])this[_0x157f33('0x41')]['sheet'][_0x157f33('0x3e')]();return{'imported':{'name':_0x2a9ed1[_0x157f33('0x25')],'actor':this[_0x157f33('0x41')],'embeddedEntity':_0x2bbb8e},'status':UtilApplications[_0x157f33('0x6e')]};}[_0x3cc93e('0x10')](_0x12fb9a,_0x40e738){const _0x21e7ff=_0x3cc93e;return DataConverterSpell[_0x21e7ff('0x27')](_0x12fb9a,{...UtilActors[_0x21e7ff('0x61')](),..._0x40e738});}static[_0x3cc93e('0x5b')](_0x380481){const _0x117403=_0x3cc93e;return''+Parser[_0x117403('0x4d')](_0x380481[_0x117403('0x29')])+(_0x380481[_0x117403('0x63')]&&_0x380481[_0x117403('0x63')][_0x117403('0x35')]?_0x117403('0x51'):'')+(_0x380481['meta']&&_0x380481['meta'][_0x117403('0x24')]?_0x117403('0x8'):'');}}ImportListSpell['DetailPreparation']=class extends Application{constructor(_0x30fc40,_0x506847,_0x33ff10){const _0x3f7bd6=_0x3cc93e;super({'title':_0x3f7bd6('0x34'),'template':SharedConsts[_0x3f7bd6('0x16')]+'/template/ImportListSpellDetailPreparation.handlebars','width':0x3c0,'height':Util[_0x3f7bd6('0x46')](),'resizable':!![]}),this['_dataList']=_0x30fc40,this['_resolve']=_0x506847,this['_titleSearch']=_0x33ff10[_0x3f7bd6('0x2e')],this[_0x3f7bd6('0x48')]=null,this[_0x3f7bd6('0x67')]=null;}[_0x3cc93e('0x28')](){const _0x44f4f9=_0x3cc93e;return{'titleSearch':this[_0x44f4f9('0x6')],'rows':this[_0x44f4f9('0x54')][_0x44f4f9('0x21')]((_0x2fe8f6,_0x231806)=>({'name':_0x2fe8f6[_0x44f4f9('0x25')],'level':ImportListSpell[_0x44f4f9('0x5b')](_0x2fe8f6),'source':_0x2fe8f6[_0x44f4f9('0x74')],'sourceShort':Parser[_0x44f4f9('0x1e')](_0x2fe8f6[_0x44f4f9('0x74')]),'sourceLong':Parser[_0x44f4f9('0x2f')](_0x2fe8f6[_0x44f4f9('0x74')]),'sourceClassName':Parser['sourceJsonToColor'](_0x2fe8f6[_0x44f4f9('0x74')]),'ix':_0x231806}))};}['activateListeners'](_0xca008d){const _0x50f0a2=_0x3cc93e;super[_0x50f0a2('0x33')](_0xca008d),this[_0x50f0a2('0x48')]=new List({'$iptSearch':_0xca008d[_0x50f0a2('0x53')]('.search'),'$wrpList':_0xca008d[_0x50f0a2('0x53')](_0x50f0a2('0x57')),'valueNames':[_0x50f0a2('0x25'),_0x50f0a2('0x74'),_0x50f0a2('0x29'),'ix']}),SortUtil[_0x50f0a2('0x2b')](_0xca008d[_0x50f0a2('0x53')](_0x50f0a2('0x5a')),this['_list']),this['_list'][_0x50f0a2('0x71')](this[_0x50f0a2('0x54')],{'fnGetName':_0x4840ca=>_0x4840ca[_0x50f0a2('0x25')],'fnGetValues':_0x20952=>({'source':_0x20952['source'],'level':_0x20952['level']})}),this[_0x50f0a2('0x48')]['init'](),this[_0x50f0a2('0x67')]=_0xca008d[_0x50f0a2('0x53')](_0x50f0a2('0x68'))[_0x50f0a2('0x65')](()=>{const _0x3672f1=_0x50f0a2;_0xca008d[_0x3672f1('0x53')](_0x3672f1('0xc'))['val']('');if(this[_0x3672f1('0x48')])this[_0x3672f1('0x48')]['reset']();}),_0xca008d[_0x50f0a2('0x53')](_0x50f0a2('0x3c'))['click'](async()=>{const _0x5cd2d2=_0x50f0a2,_0x26b0f0=this['_list'][_0x5cd2d2('0x2a')][_0x5cd2d2('0x21')](_0x4fca90=>{const _0x57cb05=_0x5cd2d2,_0x248920=$(_0x4fca90['ele']),_0x24e833=_0x248920['find'](_0x57cb05('0x3d'))['val'](),_0x10af76=_0x248920[_0x57cb05('0x53')](_0x57cb05('0x22'))[_0x57cb05('0x12')](),_0x123ef4=_0x24e833&&_0x24e833!=='-1',_0x36ad3c=_0x10af76&&_0x10af76!=='-1';if(!_0x123ef4&&!_0x36ad3c)return this[_0x57cb05('0x54')][_0x4fca90['ix']];const _0x32390e=MiscUtil[_0x57cb05('0x5c')](this[_0x57cb05('0x54')][_0x4fca90['ix']]);_0x32390e[_0x57cb05('0x4b')]={};if(_0x123ef4)_0x32390e[_0x57cb05('0x4b')][_0x57cb05('0x0')]=!!Number(_0x24e833);if(_0x36ad3c)_0x32390e['foundryData'][_0x57cb05('0x38')]=_0x10af76;return _0x32390e;});this[_0x5cd2d2('0x2c')](_0x26b0f0),this[_0x5cd2d2('0x4f')]();});if(this[_0x50f0a2('0x67')])this[_0x50f0a2('0x67')]['click']();}async[_0x3cc93e('0x4f')](){const _0x2c2f8a=_0x3cc93e;return this[_0x2c2f8a('0x2c')](null),super[_0x2c2f8a('0x4f')]();}};export{ImportListSpell};