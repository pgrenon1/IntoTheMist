const _0x24ef=['installPackage','Installing,\x20please\x20wait...\x20(check\x20the\x20server\x20logs\x20to\x20view\x20progress)','_rows','PageFilter','checked','[name=btn-toggle-summary]','flat','\x22\x20installed\x20successfully.','toDisplay','\x20error','\x20installed.','_activateListeners_pGetManifestData','error','addItem','push','manifesturlWorld','shutDown','split','.search','Type','dependencies','pGetPackageIndex','_$iptSearch','author','\x20module\x20dependenc','bind','MODULE_LOCATION','click','_getBaseManifestUrl','\x20module','addToFilters','_typeFilter','source','Installing','Please\x20wait\x20until\x20the\x20currently\x20running\x20installation\x20completes!','Please\x20select\x20a\x20package\x20which\x20includes\x20a\x20module!','_patchInstallPackage','World','_list','trim','pGetWithCache','doAbsorbItems','modules','pInitFilterBox','_filterBox','copy','manifesturl','info','splice','pImportManifesturlModule','[data-name=\x22wrp-btns-sort\x22]','remove','forEach','find','filter','notifications','filterBox','.\x20Would\x20you\x20like\x20to\x20install\x20them?','/template/ImportSpecialPackages.handlebars','manifesturlModule','cbSel','getData','slice','.fltr__mini-view','world','_$btnReset','init','filters','val','_ACTIVE_INSTALLATION','some','join','initBtnSortHandlers','_activateListeners_initBtnRun','data','_onLoadProgress','_activateListeners_initBtnReset','ele','[name=\x22btn-run--world\x22]','constructor','_pageFilter','_packageIndex','_authorFilter','absorbFnGetData','module','Failed\x20to\x20install\x20module!\x20','_activateListeners_pInitListAndFilters','_handleFilterChange','_fType','map','warn','name','EVNT_VALCHANGE','Module','activateListeners','reset','items','entries','Module\x20\x22','setup','_activateListeners_pInstallDependencies','Please\x20select\x20something\x20to\x20import!','classList','ies','[name=\x22btn-reset\x22]','Failed\x20to\x20load\x20manifest\x20file!\x20','length','getMergedPackageIndex','pImportManifesturlWorld','_fAuthor','getValues','ImportSpecialPackages','findIndex'];(function(_0x4dca5b,_0x24ef4d){const _0x2dadf5=function(_0x207d35){while(--_0x207d35){_0x4dca5b['push'](_0x4dca5b['shift']());}};_0x2dadf5(++_0x24ef4d);}(_0x24ef,0x7f));const _0x2dad=function(_0x4dca5b,_0x24ef4d){_0x4dca5b=_0x4dca5b-0x0;let _0x2dadf5=_0x24ef[_0x4dca5b];return _0x2dadf5;};const _0x40f43c=_0x2dad;import{Vetools}from'./Vetools.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Util}from'./Util.js';import{UtilList2}from'./UtilList2.js';class ImportSpecialPackages extends Application{constructor(){const _0x3b9663=_0x2dad;super({'title':'Package\x20Importer','template':SharedConsts[_0x3b9663('0xc')]+_0x3b9663('0x2c'),'height':Util['getMaxWindowHeight'](),'width':0x320,'resizable':!![]}),this[_0x3b9663('0x43')]=null,this[_0x3b9663('0x42')]=null,this[_0x3b9663('0x65')]=null;}async['pInit'](){const _0x18f118=_0x2dad;this[_0x18f118('0x43')]=await this[_0x18f118('0x41')][_0x18f118('0x5d')](),this[_0x18f118('0x42')]=new ImportSpecialPackages[(_0x18f118('0x66'))]();}static async[_0x40f43c('0x5d')](){const _0x47943f=_0x40f43c,_0x207d35=MiscUtil[_0x47943f('0x1f')](await Vetools[_0x47943f('0x7')]()),_0x1361a5=[];return(_0x207d35[_0x47943f('0x46')]||[])[_0x47943f('0x26')](_0x81abab=>{const _0x19e476=_0x47943f;_0x1361a5['push'](_0x81abab),_0x81abab[_0x19e476('0x2d')]=_0x81abab[_0x19e476('0x20')],delete _0x81abab['manifesturl'];const _0x11f7ed=(_0x81abab[_0x19e476('0x2d')]||'')[_0x19e476('0x3')]('/')[_0x19e476('0x30')](0x0,-0x1)[_0x19e476('0x39')]('/'),_0xc9fe5d=_0x207d35[_0x19e476('0x32')][_0x19e476('0x62')](_0x582615=>{const _0x428ef0=_0x19e476;if(_0x582615[_0x428ef0('0x12')]!==_0x81abab['source'])return![];const _0xb3d4e4=this[_0x428ef0('0xe')](_0x582615[_0x428ef0('0x20')]);return _0xb3d4e4===_0x11f7ed;});if(!~_0xc9fe5d)return;const [_0x262065]=_0x207d35[_0x19e476('0x32')][_0x19e476('0x22')](_0xc9fe5d,0x1);_0x262065['manifesturlWorld']=_0x262065[_0x19e476('0x20')],delete _0x262065['manifesturl'],Object[_0x19e476('0x53')](_0x262065)['forEach'](([_0x332346,_0x354a3b])=>{if(_0x81abab[_0x332346])return;_0x81abab[_0x332346]=_0x354a3b;});}),(_0x207d35[_0x47943f('0x32')]||[])[_0x47943f('0x26')](_0xcafc64=>{const _0x545393=_0x47943f;_0xcafc64[_0x545393('0x1')]=_0xcafc64[_0x545393('0x20')],delete _0xcafc64[_0x545393('0x20')],_0x1361a5[_0x545393('0x0')](_0xcafc64);}),_0x1361a5[_0x47943f('0x26')](_0x568e2d=>{const _0x3eb420=_0x47943f;_0x568e2d[_0x3eb420('0x9')]=[_0x568e2d[_0x3eb420('0x9')]||''][_0x3eb420('0x69')]()[_0x3eb420('0x4b')](_0x5be4de=>_0x5be4de[_0x3eb420('0x19')]())[_0x3eb420('0x28')](Boolean);}),_0x1361a5;}[_0x40f43c('0x2f')](){const _0x590003=_0x40f43c;return this[_0x590003('0x65')]=this[_0x590003('0x43')],{'packages':this[_0x590003('0x65')]};}['activateListeners'](_0x873c4){const _0x1cecf0=_0x40f43c;super[_0x1cecf0('0x50')](_0x873c4),this['_activateListeners_initBtnRun'](_0x873c4),this[_0x1cecf0('0x3e')](_0x873c4),this[_0x1cecf0('0x48')](_0x873c4);}['_activateListeners_getSelectedRow'](){const _0x4f6c61=_0x40f43c,_0x171171=this[_0x4f6c61('0x18')][_0x4f6c61('0x52')][_0x4f6c61('0x27')](_0x1d2724=>_0x1d2724[_0x4f6c61('0x3c')][_0x4f6c61('0x2e')][_0x4f6c61('0x67')]);if(!_0x171171)return ui[_0x4f6c61('0x29')][_0x4f6c61('0x4c')](_0x4f6c61('0x57')),null;return _0x171171[_0x4f6c61('0x3f')][_0x4f6c61('0x58')][_0x4f6c61('0x25')]('list-multi-selected'),_0x171171['data']['cbSel'][_0x4f6c61('0x67')]=![],this[_0x4f6c61('0x65')][_0x171171['ix']];}static async[_0x40f43c('0x6e')](_0x36f0f3){const _0x268cad=_0x40f43c;let _0x3ff384;try{_0x3ff384=await Vetools[_0x268cad('0x1a')](_0x36f0f3);}catch(_0x465f62){ui[_0x268cad('0x29')]['error'](_0x268cad('0x5b')+VeCt['STR_SEE_CONSOLE']);throw _0x465f62;}return _0x3ff384;}static async[_0x40f43c('0x56')](_0x2f2711,_0x17435c){const _0x42f76a=_0x40f43c;if(!_0x17435c[_0x42f76a('0x6')])return;const _0x557c46=(_0x17435c[_0x42f76a('0x6')]||[])[_0x42f76a('0x28')](_0x5066fe=>!game[_0x42f76a('0x3c')][_0x42f76a('0x1c')][_0x42f76a('0x38')](_0x15a116=>_0x15a116['id']===_0x5066fe[_0x42f76a('0x4d')]));if(!_0x557c46['length'])return;const _0x27f913=await InputUiUtil['pGetUserBoolean']({'title':_0x2f2711+'\x20\x22'+_0x17435c['name']+'\x22\x20has\x20'+_0x557c46[_0x42f76a('0x5c')]+_0x42f76a('0xa')+(_0x557c46[_0x42f76a('0x5c')]===0x1?'y':_0x42f76a('0x59'))+_0x42f76a('0x2b')});if(!_0x27f913)return;let _0x3a9ceb=0x0;SceneNavigation[_0x42f76a('0x3d')]('Installing',0x0);for(let _0x46d24b=0x0;_0x46d24b<_0x557c46['length'];++_0x46d24b){try{this['_patchInstallPackage'](),await SetupConfiguration['installPackage']({'manifest':_0x557c46[_0x46d24b]['manifest']});}catch(_0x135fdd){_0x3a9ceb++,console[_0x42f76a('0x6f')](_0x135fdd);}SceneNavigation[_0x42f76a('0x3d')](_0x42f76a('0x13'),(_0x46d24b+0x1)/miss[_0x42f76a('0x5c')]*0x64);}const _0x5da8a8=_0x557c46['length']-_0x3a9ceb;ui[_0x42f76a('0x29')][_0x3a9ceb?_0x42f76a('0x6f'):_0x42f76a('0x21')](_0x5da8a8+_0x42f76a('0xf')+(_0x5da8a8===0x1?'':'s')+_0x42f76a('0x6d')+(_0x3a9ceb?'\x20'+_0x3a9ceb+_0x42f76a('0x6c')+(_0x3a9ceb===0x1?'':'s')+'.\x20'+VeCt['STR_SEE_CONSOLE']:''));if(!_0x3a9ceb&&_0x5da8a8)game[_0x42f76a('0x2')]();}static async['pImportManifesturlModule'](_0x18c4b5){const _0x330e8d=_0x40f43c,_0x43bc7b=await this[_0x330e8d('0x6e')](_0x18c4b5);if(!_0x43bc7b)return;if(ImportSpecialPackages[_0x330e8d('0x37')])return ui[_0x330e8d('0x29')][_0x330e8d('0x4c')](_0x330e8d('0x14'));ImportSpecialPackages['_ACTIVE_INSTALLATION']=!![];try{ui['notifications'][_0x330e8d('0x21')](_0x330e8d('0x64')),this[_0x330e8d('0x16')](),await SetupConfiguration[_0x330e8d('0x63')]({'type':_0x330e8d('0x46'),'name':_0x43bc7b[_0x330e8d('0x4d')],'manifest':_0x18c4b5});}catch(_0x383947){ui['notifications']['error'](_0x330e8d('0x47')+VeCt['STR_SEE_CONSOLE']);throw _0x383947;}finally{ImportSpecialPackages['_ACTIVE_INSTALLATION']=![];}await this['_activateListeners_pInstallDependencies'](_0x330e8d('0x4f'),_0x43bc7b),ui[_0x330e8d('0x29')][_0x330e8d('0x21')](_0x330e8d('0x54')+_0x43bc7b[_0x330e8d('0x4d')]+_0x330e8d('0x6a'));}static async[_0x40f43c('0x5e')](_0x4c9505){const _0x329c18=_0x40f43c,_0xf52c81=await this[_0x329c18('0x6e')](_0x4c9505);if(!_0xf52c81)return;if(ImportSpecialPackages[_0x329c18('0x37')])return ui[_0x329c18('0x29')][_0x329c18('0x4c')](_0x329c18('0x14'));ImportSpecialPackages[_0x329c18('0x37')]=!![];try{ui['notifications'][_0x329c18('0x21')](_0x329c18('0x64')),this[_0x329c18('0x16')](),await SetupConfiguration[_0x329c18('0x63')]({'type':_0x329c18('0x32'),'name':_0xf52c81[_0x329c18('0x4d')],'manifest':_0x4c9505});}catch(_0x5c17b8){ui[_0x329c18('0x29')][_0x329c18('0x6f')]('Failed\x20to\x20install\x20world!\x20'+VeCt['STR_SEE_CONSOLE']);throw _0x5c17b8;}finally{ImportSpecialPackages['_ACTIVE_INSTALLATION']=![];}ui[_0x329c18('0x29')][_0x329c18('0x21')]('World\x20\x22'+_0xf52c81[_0x329c18('0x4d')]+_0x329c18('0x6a'));}[_0x40f43c('0x3b')](_0x11d2a5){const _0x181b73=_0x40f43c;_0x11d2a5[_0x181b73('0x27')]('[name=\x22btn-run--module\x22]')[_0x181b73('0xd')](async()=>{const _0x464e30=_0x181b73;if(!this[_0x464e30('0x18')])return;const _0x233a54=this['_activateListeners_getSelectedRow']();if(!_0x233a54)return;if(!_0x233a54[_0x464e30('0x2d')])return ui[_0x464e30('0x29')][_0x464e30('0x4c')]('Please\x20select\x20a\x20package\x20which\x20includes\x20a\x20module!');await this[_0x464e30('0x41')][_0x464e30('0x23')](_0x233a54['manifesturlModule']);}),_0x11d2a5['find'](_0x181b73('0x40'))['click'](async()=>{const _0x2320d9=_0x181b73;if(!this[_0x2320d9('0x18')])return;const _0x4b7964=this['_activateListeners_getSelectedRow']();if(!_0x4b7964)return;if(!_0x4b7964[_0x2320d9('0x1')])return ui[_0x2320d9('0x29')][_0x2320d9('0x4c')](_0x2320d9('0x15'));await this['constructor'][_0x2320d9('0x5e')](_0x4b7964[_0x2320d9('0x1')]);});}['_activateListeners_initBtnReset'](_0x4f6393){const _0x5aa41e=_0x40f43c;this[_0x5aa41e('0x33')]=_0x4f6393['find'](_0x5aa41e('0x5a'))['click'](()=>{const _0x180ba8=_0x5aa41e;_0x4f6393[_0x180ba8('0x27')]('.search')[_0x180ba8('0x36')]('');if(this[_0x180ba8('0x18')])this[_0x180ba8('0x18')][_0x180ba8('0x51')]();});}[_0x40f43c('0x48')](_0x2e0f37){const _0x466521=_0x40f43c;return this['_$iptSearch']=_0x2e0f37[_0x466521('0x27')](_0x466521('0x4')),this[_0x466521('0x18')]=new List({'$iptSearch':this[_0x466521('0x8')],'$wrpList':_0x2e0f37[_0x466521('0x27')]('.veapp__list')}),SortUtil[_0x466521('0x3a')](_0x2e0f37[_0x466521('0x27')](_0x466521('0x24')),this['_list']),this[_0x466521('0x42')][_0x466521('0x1d')]({'$iptSearch':this[_0x466521('0x8')],'$btnReset':this[_0x466521('0x33')],'$btnOpen':_0x2e0f37[_0x466521('0x27')]('[name=btn-filter]'),'$btnToggleSummaryHidden':_0x2e0f37[_0x466521('0x27')](_0x466521('0x68')),'$wrpMiniPills':_0x2e0f37[_0x466521('0x27')](_0x466521('0x31')),'namespace':_0x466521('0x61')})['then'](()=>{const _0x3248d1=_0x466521;this['_rows'][_0x3248d1('0x26')](_0xba8a5=>this['_pageFilter'][_0x3248d1('0x10')](_0xba8a5)),this[_0x3248d1('0x18')][_0x3248d1('0x1b')](this[_0x3248d1('0x65')],{'fnGetName':_0x5f1bde=>_0x5f1bde['name'],'fnGetValues':_0x416382=>({'name':_0x416382[_0x3248d1('0x4d')],'author':_0x416382['author'],'module':!!_0x416382[_0x3248d1('0x2d')],'world':!!_0x416382[_0x3248d1('0x1')]}),'fnGetData':UtilList2[_0x3248d1('0x45')],'fnBindListeners':_0x4e766b=>UtilList2['absorbFnBindListenersRadio'](this[_0x3248d1('0x18')],_0x4e766b)}),this['_list'][_0x3248d1('0x34')](),this['_pageFilter'][_0x3248d1('0x2a')]['render'](),this[_0x3248d1('0x42')][_0x3248d1('0x2a')]['on'](FilterBox[_0x3248d1('0x4e')],this[_0x3248d1('0x49')][_0x3248d1('0xb')](this)),this[_0x3248d1('0x49')]();});}[_0x40f43c('0x49')](){const _0x5baad1=_0x40f43c,_0x11922e=this[_0x5baad1('0x42')]['filterBox'][_0x5baad1('0x60')]();this[_0x5baad1('0x18')]['filter'](_0x4e0c6d=>this[_0x5baad1('0x42')]['toDisplay'](_0x11922e,this[_0x5baad1('0x65')][_0x4e0c6d['ix']]));}static[_0x40f43c('0xe')](_0x52a6ac){const _0x40690c=_0x40f43c;return(_0x52a6ac||'')['split']('/')[_0x40690c('0x30')](0x0,-0x1)[_0x40690c('0x39')]('/');}static['_patchInstallPackage'](){const _0x4bc201=_0x40f43c;ui[_0x4bc201('0x55')]=ui[_0x4bc201('0x55')]||{'reload':()=>{}};}}ImportSpecialPackages[_0x40f43c('0x37')]=null,ImportSpecialPackages[_0x40f43c('0x66')]=class extends PageFilter{constructor(){const _0x3bf031=_0x40f43c;super(),this['_typeFilter']=new Filter({'header':_0x3bf031('0x5')}),this['_authorFilter']=new Filter({'header':'Author'});}['mutateForFilters'](_0x304dfe){const _0x3b2296=_0x40f43c;_0x304dfe[_0x3b2296('0x4a')]=[];if(_0x304dfe[_0x3b2296('0x2d')])_0x304dfe['_fType'][_0x3b2296('0x0')](_0x3b2296('0x4f'));if(_0x304dfe[_0x3b2296('0x1')])_0x304dfe[_0x3b2296('0x4a')][_0x3b2296('0x0')](_0x3b2296('0x17'));_0x304dfe[_0x3b2296('0x5f')]=_0x304dfe[_0x3b2296('0x9')]||'Unknown';}[_0x40f43c('0x10')](_0x9af11d,_0x5def91){const _0x243e42=_0x40f43c;if(_0x5def91)return;this[_0x243e42('0x11')][_0x243e42('0x70')](_0x9af11d[_0x243e42('0x4a')]),this[_0x243e42('0x44')]['addItem'](_0x9af11d[_0x243e42('0x5f')]);}async['_pPopulateBoxOptions'](_0xdc857b){const _0x49ff66=_0x40f43c;_0xdc857b[_0x49ff66('0x35')]=[this['_typeFilter'],this[_0x49ff66('0x44')]];}[_0x40f43c('0x6b')](_0x4b2ff8,_0x363b3c){const _0x100e41=_0x40f43c;return this[_0x100e41('0x1e')][_0x100e41('0x6b')](_0x4b2ff8,_0x363b3c['_fType'],_0x363b3c[_0x100e41('0x5f')]);}};export{ImportSpecialPackages};