const _0x31b3=['PG_OPT_FEATURES','data','doShowImportedNotification','val','rivet.receive','Plutonium\x20does\x20not\x20yet\x20support\x20entities\x20from\x20\x22','PG_VARIANTRULES','isSendRolls','log','isWhisper','entity','PG_FEATS','roll','PG_SPELLS','\x22!\x20You\x20may\x20need\x20to\x20update\x20your\x20extension.','dice','get','TASK_EXIT_FAILED','notifications','last','trim','init','addEventListener','PG_CONDITIONS_DISEASES','toMessage','page','_pHandleEntityMessage','targetActorId','error','rivet','_handleRollMessage','_handlePacket','settings','pInit','type','Received\x20Rivet\x20message\x20(JSON)','PG_VEHICLES','remove','isTemp','textarea.rivet-transfer','PG_RACES','rivet.receive-text','parse'];(function(_0xbbbe47,_0x31b3b8){const _0x2c85cb=function(_0x16f530){while(--_0x16f530){_0xbbbe47['push'](_0xbbbe47['shift']());}};_0x2c85cb(++_0x31b3b8);}(_0x31b3,0x15e));const _0x2c85=function(_0xbbbe47,_0x31b3b8){_0xbbbe47=_0xbbbe47-0x0;let _0x2c85cb=_0x31b3[_0xbbbe47];return _0x2c85cb;};const _0x5d00cf=_0x2c85;'use strict';import{ImportListFeat}from'./ImportListFeat.js';import{ImportListCreature}from'./ImportListCreature.js';import{ImportListSpell}from'./ImportListSpell.js';import{ImportListItem}from'./ImportListItem.js';import{ImportListRace}from'./ImportListRace.js';import{ImportListClass}from'./ImportListClass.js';import{ImportListBackground}from'./ImportListBackground.js';import{ImportListVariantRule}from'./ImportListVariantRule.js';import{ImportListRollableTable}from'./ImportListRollableTable.js';import{ImportListPsionic}from'./ImportListPsionic.js';import{ImportListOptionalFeature}from'./ImportListOptionalFeature.js';import{ImportListConditionDisease}from'./ImportListConditionDisease.js';import{ImportListVehicle}from'./ImportListVehicle.js';import{Config}from'./Config.js';import{LGT}from'./Util.js';import{UtilApplications}from'./UtilApplications.js';import{ActorCharactermancerSourceSelector}from'./ActorCharactermancer.js';class RivetBridge{static[_0x5d00cf('0xf')](){const _0x2e94da=_0x5d00cf;window['addEventListener'](_0x2e94da('0x29'),_0x16f530=>{const _0x5cb6d2=_0x2e94da;console[_0x5cb6d2('0x2')](...LGT,_0x5cb6d2('0x1d')),this[_0x5cb6d2('0x19')](_0x16f530['detail']);}),window[_0x2e94da('0x10')](_0x2e94da('0x23'),()=>{const _0x128f89=_0x2e94da;console[_0x128f89('0x2')](...LGT,'Received\x20Rivet\x20message\x20(text)');const _0x264ff5=$(_0x128f89('0x21')),_0x257f5b=_0x264ff5[_0x128f89('0xd')]()[_0x128f89('0x28')]();_0x264ff5[_0x128f89('0x1f')](),this[_0x128f89('0x19')](JSON[_0x128f89('0x24')](_0x257f5b));});}static[_0x5d00cf('0x19')](_0x1353ef){const _0x54f00b=_0x5d00cf;switch(_0x1353ef[_0x54f00b('0x1c')]){case _0x54f00b('0x6'):return this['_handleRollMessage'](_0x1353ef);case _0x54f00b('0x4'):return this[_0x54f00b('0x14')](_0x1353ef);default:ui[_0x54f00b('0xc')][_0x54f00b('0x16')]('Unhandled\x20Rivet\x20message\x20with\x20type\x20\x22'+_0x1353ef['type']+_0x54f00b('0x8'));}}static[_0x5d00cf('0x18')](_0x46e1f3){const _0x8d9427=_0x5d00cf,_0x2cacb3=_0x46e1f3['data'];if(!_0x46e1f3['settings'][_0x8d9427('0x1')])return;const _0x26066e=new Roll(_0x2cacb3[_0x8d9427('0x9')]),_0x263f5e=[];if(_0x46e1f3[_0x8d9427('0x1a')][_0x8d9427('0x3')])_0x263f5e['push'](game['userId']);_0x26066e[_0x8d9427('0x12')]({'speaker':{'alias':_0x2cacb3['rolledBy']},'flavor':_0x2cacb3['label'],'rollMode':_0x8d9427('0x6'),'whisper':_0x263f5e});}static async[_0x5d00cf('0x14')](_0x3484ce){const _0x3f40fd=_0x5d00cf,_0x29e60b=Config[_0x3f40fd('0xa')]('import','minimumRole');if(game['user']['role']<_0x29e60b)return;const _0x29f25c=_0x3484ce[_0x3f40fd('0x26')],_0x3acd12=(Config[_0x3f40fd('0xa')](_0x3f40fd('0x17'),_0x3f40fd('0x15'))||'')[_0x3f40fd('0xe')](),_0x2dac78=_0x3acd12?Actor['collection'][_0x3f40fd('0xa')](_0x3acd12):'',_0x36563e=(()=>{const _0x9fe21b=_0x3f40fd;switch(_0x29f25c[_0x9fe21b('0x13')]){case UrlUtil[_0x9fe21b('0x5')]:return new ImportListFeat({'actor':_0x2dac78});case UrlUtil['PG_BESTIARY']:return new ImportListCreature({});case UrlUtil[_0x9fe21b('0x7')]:return new ImportListSpell({'actor':_0x2dac78});case UrlUtil['PG_ITEMS']:return new ImportListItem({'actor':_0x2dac78});case UrlUtil[_0x9fe21b('0x22')]:return new ImportListRace({'actor':_0x2dac78});case UrlUtil['PG_BACKGROUNDS']:return new ImportListBackground({'actor':_0x2dac78});case UrlUtil[_0x9fe21b('0x0')]:return new ImportListVariantRule({});case UrlUtil['PG_TABLES']:return new ImportListRollableTable({});case UrlUtil['PG_PSIONICS']:return new ImportListPsionic({'actor':_0x2dac78});case UrlUtil[_0x9fe21b('0x25')]:return new ImportListOptionalFeature({'actor':_0x2dac78});case UrlUtil[_0x9fe21b('0x11')]:return new ImportListConditionDisease({'actor':_0x2dac78});case UrlUtil[_0x9fe21b('0x1e')]:return new ImportListVehicle({});default:return null;}})();if(!_0x36563e)return ui['notifications'][_0x3f40fd('0x16')](_0x3f40fd('0x2a')+_0x29f25c[_0x3f40fd('0x13')]+_0x3f40fd('0x8'));try{await _0x36563e[_0x3f40fd('0x1b')]();const _0x7e134d={};if(_0x29f25c[_0x3f40fd('0x20')])_0x7e134d[_0x3f40fd('0x20')]=!![];const _0xddf786=await _0x36563e['pImportEntry'](_0x29f25c[_0x3f40fd('0x4')],_0x7e134d);UtilApplications[_0x3f40fd('0x27')](_0xddf786);}catch(_0x103102){UtilApplications[_0x3f40fd('0x27')]({'entity':_0x29f25c,'status':UtilApplications[_0x3f40fd('0xb')]}),setTimeout(()=>{throw _0x103102;});}}}export{RivetBridge};