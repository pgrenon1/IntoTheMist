const _0x442e=['call','menu','animate','<button><i\x20class=\x22fas\x20fa-cogs\x22></i>\x20Configure\x20','keys','renderSettings','add','get','activeLayer','insertAfter','renderItemDirectory','isHidePlutoniumDirectoryButtons','each','dir__btn-header','span','button[data-action=\x22configure\x22]','#compendium','Plutonium\x20','_doRenderSettings_handleConfigFixEscapeKey','remove','compendium','_doRenderSettings_handleConfigHidePlutoniumDirectoryButtons','dir__btn-header\x20dir__control-header--alt','slideDown','.action-buttons','isFastAnimations','cacheMethod','keyboard','.ui__btn-open-menu','isFixEscapeKey','_onEscape','plutonium.configUpdate','hasFocus','sort','.cfg__btn-open-alt','.header-actions','filter','appendTo','.ui__wrp-player-settings','insertBefore','isEscapeable','style','entries','restoreCachedMethod','SRD\x20Module','isStreamerMode','click','context','addClass','<div\x20class=\x22w-100\x22></div>','duration','zIndex','saveFog','warn','text','element','appId','renderJournalDirectory','windows','z-index','_init_addDirectoryWrapper','role','getCachedMethod','ready','ascSort','_handled','_handleConfigUpdate','$getDirButton','.dir__wrp-footer','key','renderRollTableDirectory','init','Could\x20not\x20determine\x20z-index\x20for\x20app\x20','import','</button>','sight','_ELEMENTS_WITH_FOCUS','renderCompendiumDirectory','length','has','map','_plut_IsPopout','renderActorDirectory','target','find','_MODAL_STACK','isGM','getCoreVersion','nodeName','minimumRole','INPUT','_controlled','TEXTAREA','.game-system','.compendium-footer','prototype','_handleConfigUpdate_handleFastAnimations','trim','.dir__wrp-header','MODULE_NAME','user','_doRenderSettings_addPlayerConfigButton'];(function(_0x27ea9e,_0x442e02){const _0x4675bd=function(_0x4179c0){while(--_0x4179c0){_0x27ea9e['push'](_0x27ea9e['shift']());}};_0x4675bd(++_0x442e02);}(_0x442e,0xc0));const _0x4675=function(_0x27ea9e,_0x442e02){_0x27ea9e=_0x27ea9e-0x0;let _0x4675bd=_0x442e[_0x27ea9e];return _0x4675bd;};const _0x4173f1=_0x4675;'use strict';import{Config}from'./Config.js';import{ChooseImporter}from'./ChooseImporter.js';import{MenuCollectionTools}from'./MenuCollectionTools.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilPatch}from'./UtilPatch.js';import{Menu}from'./Menu.js';class UtilUi{static[_0x4173f1('0x53')](){const _0x32aaf0=_0x4173f1;game[_0x32aaf0('0xa')][_0x32aaf0('0x62')]&&(UtilUi[_0x32aaf0('0x48')](_0x32aaf0('0x5e')),UtilUi['_init_addDirectoryWrapper'](_0x32aaf0('0x16')),UtilUi[_0x32aaf0('0x48')](_0x32aaf0('0x45')),UtilUi[_0x32aaf0('0x48')](_0x32aaf0('0x52'))),UtilUi['_init_addCompendiumObfuscation'](),Hooks['on'](_0x32aaf0('0x2b'),()=>this[_0x32aaf0('0x4e')]()),this[_0x32aaf0('0x4e')]();}static['_init_addCompendiumObfuscation'](){const _0x535b16=_0x4173f1,_0x4179c0='('+SharedConsts[_0x535b16('0x9')]+')';Hooks['on'](_0x535b16('0x59'),()=>{const _0xc68358=_0x535b16;if(!Config[_0xc68358('0x13')]('ui',_0xc68358('0x39')))return;$(_0xc68358('0x1c'))['find'](_0xc68358('0x4'))[_0xc68358('0x18')]((_0x100401,_0x12ae62)=>{const _0x32f531=_0xc68358;$(_0x12ae62)['find'](_0x32f531('0x1a'))['filter']((_0x1d42d7,_0x2eaa0a)=>$(_0x2eaa0a)[_0x32f531('0x42')]()[_0x32f531('0x7')]()===_0x4179c0)[_0x32f531('0x42')]('\x20(Expanded\x20SRD)');});});if(!Config[_0x535b16('0x63')]()['isZeroSix'])ui[_0x535b16('0x20')]['render']();}static[_0x4173f1('0x48')](_0x4d7661){const _0x1b7507=_0x4173f1,_0x6ba1cc=Config[_0x1b7507('0x13')](_0x1b7507('0x55'),_0x1b7507('0x65')),_0x1a2b41=game[_0x1b7507('0xa')][_0x1b7507('0x49')]>=_0x6ba1cc;Config['getCoreVersion']()['isZeroSix']?Hooks['on'](_0x4d7661,(_0x28a44a,_0x28ac7f)=>{const _0x16c72f=_0x1b7507;_0x28ac7f['find'](_0x16c72f('0x50'))[_0x16c72f('0x1f')](),$$`<div class="flex-col dir__wrp-footer w-100 no-shrink min-w-100">
					<hr class="w-100 m-1">
					<div class="flex w-100">
						${_0x1a2b41?ChooseImporter[_0x16c72f('0x4f')](_0x4d7661):_0x16c72f('0x3d')}
						${MenuCollectionTools[_0x16c72f('0x4f')](_0x4d7661)}
						${Config['$getDirButton']()}
					</div>
				</div>`[_0x16c72f('0x31')](_0x28ac7f[_0x16c72f('0x60')]('.directory-footer'));}):Hooks['on'](_0x4d7661,(_0x2d9870,_0x88a6)=>{const _0x36d68f=_0x1b7507;_0x88a6[_0x36d68f('0x60')](_0x36d68f('0x8'))['remove'](),$$`<div class="flex-col dir__wrp-header w-100 no-shrink min-w-100 dir__control-header">
					<div class="flex w-100">
						${_0x1a2b41?ChooseImporter[_0x36d68f('0x4f')](_0x4d7661)['addClass'](_0x36d68f('0x19')):_0x36d68f('0x3d')}
						${MenuCollectionTools[_0x36d68f('0x4f')](_0x4d7661)[_0x36d68f('0x3c')]('dir__btn-header')}
						${Config[_0x36d68f('0x4f')]()[_0x36d68f('0x3c')]('dir__btn-header')}
					</div>
				</div>`[_0x36d68f('0x15')](_0x88a6[_0x36d68f('0x60')](_0x36d68f('0x2f'))),MenuCollectionTools[_0x36d68f('0x4f')](_0x4d7661)[_0x36d68f('0x3c')](_0x36d68f('0x22'))['css']({'maxWidth':0x1c})[_0x36d68f('0x31')](_0x88a6[_0x36d68f('0x60')](_0x36d68f('0x24')));}),Hooks['on'](_0x1b7507('0x11'),(_0x324944,_0x43d4c4)=>{const _0x5ceeab=_0x1b7507;this[_0x5ceeab('0x1e')](_0x324944,_0x43d4c4),this[_0x5ceeab('0x21')](_0x324944,_0x43d4c4),this[_0x5ceeab('0xb')](_0x324944,_0x43d4c4);});}static['_handleConfigUpdate'](){const _0x16eae2=_0x4173f1;this[_0x16eae2('0x6')](),this['_handleConfigUpdate_handleFixEscapeKey']();}static[_0x4173f1('0x6')](){const _0x5dfd92=_0x4173f1;UtilPatch[_0x5dfd92('0x26')]($[_0x5dfd92('0x5')],_0x5dfd92('0xe'));if(!Config[_0x5dfd92('0x13')]('ui',_0x5dfd92('0x25'))){UtilPatch[_0x5dfd92('0x37')]($[_0x5dfd92('0x5')],_0x5dfd92('0xe'));return;}$[_0x5dfd92('0x5')]['animate']=function(..._0x321cf0){const _0x4eacc4=_0x5dfd92,_0x3b1812=[..._0x321cf0];for(let _0x1aa6e7=0x0;_0x1aa6e7<_0x3b1812[_0x4eacc4('0x5a')];++_0x1aa6e7){const _0x52292d=_0x3b1812[_0x1aa6e7];if(typeof _0x52292d==='object'&&_0x52292d[_0x4eacc4('0x3e')]!=null){if(_0x52292d[_0x4eacc4('0x3e')]>0x21)_0x52292d[_0x4eacc4('0x3e')]=0x21;break;}else{if(typeof _0x52292d==='number'){if(_0x52292d>0x21)_0x3b1812[_0x1aa6e7]=0x21;break;}}}const _0x39eaeb=UtilPatch['getCachedMethod']($[_0x4eacc4('0x5')],_0x4eacc4('0xe'));_0x39eaeb[_0x4eacc4('0xc')](this,..._0x3b1812);};}static['_handleConfigUpdate_handleFixEscapeKey'](){const _0x1c1f53=_0x4173f1;ui['settings']['render'](),UtilPatch[_0x1c1f53('0x26')](game[_0x1c1f53('0x27')],_0x1c1f53('0x2a'),{'isBind':!![]});if(!Config['get']('ui',_0x1c1f53('0x29'))){game[_0x1c1f53('0x27')]['_onEscape']=function(_0x1fb1ea,_0x50de40,_0x3fd152){const _0x58fedc=_0x1c1f53;if(UiUtil['_MODAL_STACK']&&UiUtil['_MODAL_STACK'][_0x58fedc('0x5a')])return;UtilPatch[_0x58fedc('0x4a')](game['keyboard'],_0x58fedc('0x2a'))(_0x1fb1ea,_0x50de40,_0x3fd152);};return;}game[_0x1c1f53('0x27')][_0x1c1f53('0x2a')]=function(_0x31c671,_0xbf81a7,_0x2b6664){const _0x5dc3c8=_0x1c1f53;if(UiUtil[_0x5dc3c8('0x61')]&&UiUtil['_MODAL_STACK']['length'])return;if(_0xbf81a7)return;if(_0x2b6664[_0x5dc3c8('0x2c')]&&UtilUi[_0x5dc3c8('0x58')][_0x5dc3c8('0x5b')](_0x31c671['target'][_0x5dc3c8('0x64')])){_0x31c671[_0x5dc3c8('0x5f')]['blur']();return;}if(canvas[_0x5dc3c8('0x4b')])canvas[_0x5dc3c8('0x57')][_0x5dc3c8('0x40')]();if(ui[_0x5dc3c8('0x3b')]&&ui[_0x5dc3c8('0x3b')][_0x5dc3c8('0xd')]['length'])ui['context']['close']();else{if(Menu['closeAllMenus']())return;else{if(canvas[_0x5dc3c8('0x4b')]&&Object[_0x5dc3c8('0x10')](canvas[_0x5dc3c8('0x14')][_0x5dc3c8('0x1')])[_0x5dc3c8('0x5a')])_0x31c671['preventDefault'](),canvas[_0x5dc3c8('0x14')]['releaseAll']();else{if(Object['values'](ui['windows'])[_0x5dc3c8('0x30')](_0x23df8c=>(_0x23df8c[_0x5dc3c8('0x34')]==null||_0x23df8c[_0x5dc3c8('0x34')]===!![])&&!_0x23df8c['_plut_IsPopout'])[_0x5dc3c8('0x5a')]){const _0x3c040f=Object[_0x5dc3c8('0x36')](ui[_0x5dc3c8('0x46')])['filter'](([_0x4b3a8d,_0x1fc601])=>(_0x1fc601[_0x5dc3c8('0x34')]==null||_0x1fc601[_0x5dc3c8('0x34')]===!![])&&!_0x1fc601[_0x5dc3c8('0x5d')])[_0x5dc3c8('0x5c')](([_0x20f36d,_0x56efac])=>{const _0x28f258=_0x5dc3c8,_0x7026c8=Number(((_0x56efac[_0x28f258('0x43')][0x0]||{})[_0x28f258('0x35')]||{})[_0x28f258('0x47')]||-0x1);if(isNaN(_0x7026c8)||!~_0x7026c8)console[_0x28f258('0x41')](_0x28f258('0x54')+_0x20f36d);return{'appId':_0x20f36d,'zIndex':isNaN(_0x7026c8)?-0x1:_0x7026c8};})[_0x5dc3c8('0x2d')]((_0x911952,_0x18eb1c)=>SortUtil[_0x5dc3c8('0x4c')](_0x18eb1c[_0x5dc3c8('0x3f')],_0x911952[_0x5dc3c8('0x3f')]));ui[_0x5dc3c8('0x46')][_0x3c040f[0x0][_0x5dc3c8('0x44')]]['close']();}else ui[_0x5dc3c8('0xd')]['toggle']();}}}this[_0x5dc3c8('0x4d')][_0x5dc3c8('0x12')](_0x2b6664[_0x5dc3c8('0x51')]);};}static['_doRenderSettings_handleConfigFixEscapeKey'](_0x1653aa,_0x970879){const _0x238ce3=_0x4173f1;if(!Config[_0x238ce3('0x13')]('ui',_0x238ce3('0x29')))return _0x970879[_0x238ce3('0x60')](_0x238ce3('0x28'))[_0x238ce3('0x1f')]();if(_0x970879[_0x238ce3('0x60')]('.ui__btn-open-menu')[_0x238ce3('0x5a')])return;$('<button\x20class=\x22ui__btn-open-menu\x22><i\x20class=\x22fas\x20fa-bars\x22></i>\x20Open\x20Main\x20Menu</button>')[_0x238ce3('0x3a')](()=>{const _0x508a88=_0x238ce3,_0xf943b6=ui['menu'][_0x508a88('0x43')];if(!_0xf943b6[_0x508a88('0x5a')])ui[_0x508a88('0xd')]['render'](!![]);else _0xf943b6[_0x508a88('0x23')](0x96);})[_0x238ce3('0x33')](_0x970879[_0x238ce3('0x60')](_0x238ce3('0x1b')));}static[_0x4173f1('0x21')](_0x3e4acb,_0x555b2b){const _0x5738e0=_0x4173f1;if(!Config[_0x5738e0('0x13')]('ui',_0x5738e0('0x17')))return _0x555b2b['find'](_0x5738e0('0x2e'))['remove']();if(_0x555b2b[_0x5738e0('0x60')](_0x5738e0('0x2e'))[_0x5738e0('0x5a')])return;Config['$getDirButton']({'isGameSettingsButton':!![]})[_0x5738e0('0x15')](_0x555b2b[_0x5738e0('0x60')](_0x5738e0('0x1b')));}static[_0x4173f1('0xb')](_0x1fca19,_0x50d8a0){const _0x3abc4c=_0x4173f1;if(game[_0x3abc4c('0xa')][_0x3abc4c('0x62')])return;if(_0x50d8a0['find'](_0x3abc4c('0x32'))['length'])return;const _0x1e80f5=$(_0x3abc4c('0xf')+(Config[_0x3abc4c('0x13')]('ui','isStreamerMode')?_0x3abc4c('0x38'):_0x3abc4c('0x1d'))+_0x3abc4c('0x56'))[_0x3abc4c('0x3a')](_0x59d8be=>Config['pHandleButtonClick'](_0x59d8be));$$`<div class="ui__wrp-player-settings">${_0x1e80f5}</div>`[_0x3abc4c('0x15')](_0x50d8a0['find'](_0x3abc4c('0x3')));}}UtilUi[_0x4173f1('0x58')]=new Set([_0x4173f1('0x0'),_0x4173f1('0x2')]);export{UtilUi};