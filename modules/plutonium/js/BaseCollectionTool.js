const _0x11c6=['EVNT_VALCHANGE','Delete','checked','_activateListeners_doBindSelectAll','bindSelectAllCheckbox','info','ascSortLower','doAbsorbItems','items','absorbFnGetData','Please\x20select\x20something\x20to\x20delete!','[name=\x22cb-select-all\x22]','_handleFilterChange','path','Actor','_collectionName','Task','type','_getSelectedIds','pGetConfirmation','_collection','get','_sidebarTab','render','content','init','Deleting...','forEach','close','getValues','filterBox','actor','RollTable','_mapEntitiesToRows','input','_listSortNamePathRows','unknown','Delete\x20Folders','reset','_activateListeners_listAbsorbGetData','data','collection','\x20and\x20','addToFilters','sidebar','_pDoPruneFolders','filter','uppercaseFirst','rolltable','.search','Item','Deleted\x20','_activateListeners_initBtnReset','_pageFilter','values','[name=btn-filter]','_list','...','journal','\x20folder','_folderType','toDisplay','item','its','delete','pRunTasks','has','their','Deleting\x20','Unknown\x20collection\x20\x22','entities','prop','name','children','length','_$btnReset','<h3>Are\x20you\x20sure?</h3><p>Any\x20empty\x20folders\x20will\x20be\x20permanently\x20deleted.</p>','ele','then','click','_gameProp','_rows','.veapp__list','actors','bind','[name=btn-toggle-summary]','_sortNamePathRows','sort','activateTab','map','_activateListeners_initBtnPrune','tables','Failed\x20to\x20delete\x20','STR_SEE_CONSOLE','<h3>Are\x20you\x20sure?</h3><p>','find','val','.fltr__mini-view','_$iptSearch','notifications','initBtnSortHandlers'];(function(_0x18001a,_0x11c68f){const _0x4144a7=function(_0x1918f7){while(--_0x1918f7){_0x18001a['push'](_0x18001a['shift']());}};_0x4144a7(++_0x11c68f);}(_0x11c6,0x18c));const _0x4144=function(_0x18001a,_0x11c68f){_0x18001a=_0x18001a-0x0;let _0x4144a7=_0x11c6[_0x18001a];return _0x4144a7;};const _0x203c2f=_0x4144;'use strict';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{Util}from'./Util.js';class BaseCollectionTool extends Application{static[_0x203c2f('0x5e')](_0x1918f7,_0x544aae){const _0x47c97e=_0x203c2f;if(_0x1918f7['path']==null&&_0x544aae[_0x47c97e('0x15')]==null)return SortUtil[_0x47c97e('0xe')](_0x1918f7['name'],_0x544aae['name']);if(_0x1918f7[_0x47c97e('0x15')]!=null&&_0x544aae['path']==null)return-0x1;if(_0x1918f7[_0x47c97e('0x15')]==null&&_0x544aae[_0x47c97e('0x15')]!=null)return 0x1;return SortUtil[_0x47c97e('0xe')](_0x1918f7[_0x47c97e('0x15')],_0x544aae['path'])||SortUtil[_0x47c97e('0xe')](_0x1918f7[_0x47c97e('0x50')],_0x544aae[_0x47c97e('0x50')]);}static['_listSortNamePathRows'](_0x5663d9,_0x489117,_0x30d329){const _0x10e5bf=_0x203c2f,_0x3311c3={'name':_0x5663d9[_0x10e5bf('0x50')],'path':_0x5663d9[_0x10e5bf('0x3e')][_0x10e5bf('0x15')]},_0x4ae010={'name':_0x489117[_0x10e5bf('0x50')],'path':_0x489117[_0x10e5bf('0x3e')][_0x10e5bf('0x15')]};return BaseCollectionTool['_sortNamePathRows'](_0x3311c3,_0x4ae010);}constructor(_0x2e2698,_0x46f97f){const _0x396fb6=_0x203c2f;super(_0x2e2698),this[_0x396fb6('0x17')]=_0x46f97f,this['_collection']=null,this[_0x396fb6('0x1e')]=null,this[_0x396fb6('0x58')]=null,this[_0x396fb6('0x44')]=null;switch(_0x46f97f){case _0x396fb6('0x46'):{this[_0x396fb6('0x1c')]=Item[_0x396fb6('0x31')],this[_0x396fb6('0x1e')]='items',this[_0x396fb6('0x58')]='items',this[_0x396fb6('0x44')]=_0x396fb6('0x3a');break;}case _0x396fb6('0x27'):{this[_0x396fb6('0x1c')]=Actor[_0x396fb6('0x31')],this['_sidebarTab']=_0x396fb6('0x5b'),this[_0x396fb6('0x58')]=_0x396fb6('0x5b'),this[_0x396fb6('0x44')]=_0x396fb6('0x16');break;}case _0x396fb6('0x42'):{this[_0x396fb6('0x1c')]=JournalEntry[_0x396fb6('0x31')],this[_0x396fb6('0x1e')]=_0x396fb6('0x42'),this[_0x396fb6('0x58')]=_0x396fb6('0x42'),this[_0x396fb6('0x44')]='JournalEntry';break;}case _0x396fb6('0x38'):{this[_0x396fb6('0x1c')]=RollTable[_0x396fb6('0x31')],this[_0x396fb6('0x1e')]=_0x396fb6('0x63'),this['_gameProp']=_0x396fb6('0x63'),this[_0x396fb6('0x44')]=_0x396fb6('0x28');break;}default:throw new Error(_0x396fb6('0x4d')+_0x46f97f+'\x22');}}[_0x203c2f('0x29')](){const _0x5f23a8=_0x203c2f;return this[_0x5f23a8('0x1c')][_0x5f23a8('0x4e')][_0x5f23a8('0x61')]((_0xcafe69,_0x381375)=>{const _0x561fe5=_0x5f23a8,_0x3dd2b2=UtilApplications['getFolderPath'](_0xcafe69,{'isAddTrailingSlash':!![]});return{'path':_0x3dd2b2,'name':_0xcafe69['name'],'displayName':''+(_0x3dd2b2||'')+_0xcafe69[_0x561fe5('0x50')],'id':_0xcafe69['id'],'type':MiscUtil[_0x561fe5('0x1d')](_0xcafe69,'data',_0x561fe5('0x19'))||_0x561fe5('0x2c'),'ix':_0x381375};})[_0x5f23a8('0x5f')](BaseCollectionTool[_0x5f23a8('0x5e')]);}[_0x203c2f('0x14')](){const _0x582b01=_0x203c2f,_0x37760f=this[_0x582b01('0x3d')]['filterBox'][_0x582b01('0x25')]();this[_0x582b01('0x40')][_0x582b01('0x36')](_0xf77685=>this[_0x582b01('0x3d')][_0x582b01('0x45')](_0x37760f,this[_0x582b01('0x59')][_0xf77685['ix']]));}[_0x203c2f('0x3c')](_0x5a88e){const _0x5902f8=_0x203c2f;this[_0x5902f8('0x53')]=_0x5a88e[_0x5902f8('0x2')]('[name=\x22btn-reset\x22]')[_0x5902f8('0x57')](()=>{const _0x1598ec=_0x5902f8;_0x5a88e[_0x1598ec('0x2')]('.search')[_0x1598ec('0x3')]('');if(this['_list'])this[_0x1598ec('0x40')][_0x1598ec('0x2e')]();});}['_activateListeners_listAbsorbGetData'](_0xb89a45){const _0x272d41=_0x203c2f;return UtilList2[_0x272d41('0x11')](_0xb89a45);}[_0x203c2f('0xb')](_0x5ce5ee){const _0x57d89=_0x203c2f;ListUiUtil[_0x57d89('0xc')](_0x5ce5ee,this[_0x57d89('0x40')]);}['_activateListeners_pInitListAndFilters'](_0x5ae2e8){const _0x565f85=_0x203c2f;return this[_0x565f85('0x5')]=_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x39')),this[_0x565f85('0x40')]=new List({'$iptSearch':this[_0x565f85('0x5')],'$wrpList':_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x5a')),'fnSort':BaseCollectionTool[_0x565f85('0x2b')]}),SortUtil[_0x565f85('0x7')](_0x5ae2e8[_0x565f85('0x2')]('[data-name=\x22wrp-btns-sort\x22]'),this['_list']),this[_0x565f85('0xb')](_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x13'))),this[_0x565f85('0x3d')]['pInitFilterBox']({'$iptSearch':this[_0x565f85('0x5')],'$btnReset':this[_0x565f85('0x53')],'$btnOpen':_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x3f')),'$btnToggleSummaryHidden':_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x5d')),'$wrpMiniPills':_0x5ae2e8[_0x565f85('0x2')](_0x565f85('0x4')),'namespace':'tool-folderizer_'+this[_0x565f85('0x17')]})[_0x565f85('0x56')](()=>{const _0x5a1611=_0x565f85;this[_0x5a1611('0x59')]['forEach'](_0x2178c6=>this[_0x5a1611('0x3d')][_0x5a1611('0x33')](_0x2178c6)),this[_0x5a1611('0x40')][_0x5a1611('0xf')](this[_0x5a1611('0x59')],{'fnGetName':_0x2b3936=>_0x2b3936[_0x5a1611('0x50')],'fnGetValues':_0x239eed=>({'id':_0x239eed['id'],'path':_0x239eed[_0x5a1611('0x15')]}),'fnGetData':this[_0x5a1611('0x2f')]['bind'](this),'fnBindListeners':_0x279265=>UtilList2['absorbFnBindListeners'](this[_0x5a1611('0x40')],_0x279265)}),this['_list'][_0x5a1611('0x21')](),this[_0x5a1611('0x3d')][_0x5a1611('0x26')][_0x5a1611('0x1f')](),this['_pageFilter'][_0x5a1611('0x26')]['on'](FilterBox[_0x5a1611('0x8')],this[_0x5a1611('0x14')][_0x5a1611('0x5c')](this)),this[_0x5a1611('0x14')]();});}[_0x203c2f('0x1a')](){const _0x47c8ed=_0x203c2f;return this[_0x47c8ed('0x40')][_0x47c8ed('0x10')]['filter'](_0x53b033=>$(_0x53b033[_0x47c8ed('0x55')])[_0x47c8ed('0x2')](_0x47c8ed('0x2a'))[_0x47c8ed('0x4f')]('checked'))[_0x47c8ed('0x61')](_0x4a1da0=>({'name':_0x4a1da0[_0x47c8ed('0x50')],'id':_0x4a1da0[_0x47c8ed('0x3e')]['id']}));}[_0x203c2f('0x62')](_0x1335d0){const _0x273983=_0x203c2f;_0x1335d0[_0x273983('0x2')]('[name=\x22btn-prune\x22]')['click'](async()=>{const _0x90e29=_0x273983,_0x41e6e3=await UtilApplications['pGetConfirmation']({'title':_0x90e29('0x2d'),'content':_0x90e29('0x54'),'confirmText':'Delete','faIcon':'fa-trash'});if(!_0x41e6e3)return;await this[_0x90e29('0x35')]();});}async['_pDoDelete'](_0x4fe6fd){const _0x288e3c=_0x203c2f;if(!this[_0x288e3c('0x40')])return;let _0xa479a3=this[_0x288e3c('0x1a')]();if(!_0xa479a3[_0x288e3c('0x52')])return ui['notifications']['warn'](_0x288e3c('0x12'));const _0x515404=this[_0x288e3c('0x17')][_0x288e3c('0x37')](),_0x24a2f3=_0xa479a3['length']!==0x1?'s':'',_0x3e88e1=await UtilApplications[_0x288e3c('0x1b')]({'title':'Delete\x20'+_0x515404+_0x24a2f3,'content':_0x288e3c('0x1')+_0xa479a3[_0x288e3c('0x52')]+'\x20'+_0x515404+_0x24a2f3+_0x288e3c('0x32')+(_0x24a2f3?_0x288e3c('0x4b'):_0x288e3c('0x47'))+'\x20data\x20will\x20be\x20permanently\x20deleted.</p>','confirmText':_0x288e3c('0x9'),'faIcon':'fa-trash'});if(!_0x3e88e1)return;this[_0x288e3c('0x24')](),ui[_0x288e3c('0x34')][_0x288e3c('0x60')](this[_0x288e3c('0x1e')]);if(_0x4fe6fd[_0x288e3c('0x4f')]('checked')){const _0x3eba13=await this[_0x288e3c('0x35')](_0xa479a3[_0x288e3c('0x61')](({id:_0xa3c967})=>_0xa3c967));_0xa479a3=_0xa479a3['filter'](({id:_0x434d8a})=>!_0x3eba13[_0x288e3c('0x4a')](_0x434d8a));}const _0x4717be=_0xa479a3[_0x288e3c('0x61')](({id:_0x39f627,name:_0x1c1712})=>new Util[(_0x288e3c('0x18'))](_0x1c1712,()=>this['_pDeleteItem'](_0x39f627)));await UtilApplications[_0x288e3c('0x49')](_0x4717be,{'titleInitial':_0x288e3c('0x22'),'titleComplete':'Delete\x20Complete','fnGetRowRunningText':_0x1952c6=>_0x288e3c('0x4c')+_0x1952c6+_0x288e3c('0x41'),'fnGetRowSuccessText':_0x56b159=>_0x288e3c('0x3b')+_0x56b159+'.','fnGetRowErrorText':_0x45ae74=>_0x288e3c('0x64')+_0x45ae74+'!\x20'+VeCt[_0x288e3c('0x0')]});if(_0x4fe6fd[_0x288e3c('0x4f')](_0x288e3c('0xa')))await this[_0x288e3c('0x35')]();game[this[_0x288e3c('0x58')]][_0x288e3c('0x1f')]();}async['_pDeleteItem'](_0xc29e5b){const _0x4c8985=_0x203c2f;await this['_collection'][_0x4c8985('0x1d')](_0xc29e5b)['delete']();}async['_pDoPruneFolders'](_0x4348b8){const _0x35c4ab=_0x203c2f,_0x5dd11a=()=>Folder[_0x35c4ab('0x31')][_0x35c4ab('0x4e')][_0x35c4ab('0x36')](_0xebd879=>_0xebd879[_0x35c4ab('0x30')][_0x35c4ab('0x19')]===this[_0x35c4ab('0x44')]),_0x56ca78=_0x4348b8?new Set(_0x4348b8):null,_0x4b0a68=new Set();let _0x36f95c=0x0,_0x3e7f3d=null,_0x36ac82=_0x5dd11a()['length'];do{let _0x3788c8;_0x56ca78?_0x3788c8=_0x5dd11a()[_0x35c4ab('0x36')](_0x2156f0=>{const _0x2054e4=_0x35c4ab;if(!_0x2156f0[_0x2054e4('0x51')]||!_0x2156f0[_0x2054e4('0x51')][_0x2054e4('0x52')]){if(!_0x2156f0['content'][_0x2054e4('0x52')])return!![];const _0x5ed786=_0x2156f0['content'][_0x2054e4('0x61')](_0x46a632=>_0x46a632['id'])[_0x2054e4('0x36')](_0x466ec6=>_0x56ca78['has'](_0x466ec6));if(_0x5ed786[_0x2054e4('0x52')]===_0x2156f0['content'][_0x2054e4('0x52')])return _0x5ed786[_0x2054e4('0x23')](_0x361e76=>_0x4b0a68['add'](_0x361e76)),!![];}return![];}):_0x3788c8=_0x5dd11a()[_0x35c4ab('0x36')](_0x3da1b3=>!_0x3da1b3[_0x35c4ab('0x20')]['length']&&(!_0x3da1b3[_0x35c4ab('0x51')]||!_0x3da1b3[_0x35c4ab('0x51')][_0x35c4ab('0x52')]));for(const _0x37e9f1 of _0x3788c8){await _0x37e9f1[_0x35c4ab('0x48')]({'deleteSubfolders':!![],'deleteContents':!![]}),_0x36f95c++;}_0x3e7f3d=_0x36ac82,_0x36ac82=_0x5dd11a()['length'];}while(_0x36ac82!==_0x3e7f3d);if(_0x36f95c)ui[_0x35c4ab('0x6')][_0x35c4ab('0xd')](_0x35c4ab('0x3b')+_0x36f95c+_0x35c4ab('0x43')+(_0x36f95c===0x1?'':'s')+'.');return _0x4b0a68;}}export{BaseCollectionTool};